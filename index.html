<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title> 注拽 - 转" 1142</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <style>
        body { font-family: -apple-system, system-ui, sans-serif; background: #eef2f5; direction: rtl; padding: 15px; margin: 0; }
        .card { background: white; max-width: 500px; margin: auto; border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.15); padding: 20px; border-top: 10px solid #1a4a7a; }
        h2 { text-align: center; color: #1a4a7a; margin-bottom: 20px; }
        .section-title { background: #f8f9fa; padding: 8px; font-weight: bold; border-right: 4px solid #1a4a7a; margin: 15px 0 10px 0; font-size: 14px; }
        label { display: block; font-size: 13px; font-weight: bold; margin: 10px 0 5px; color: #333; }
        input, select, textarea { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; background: #fff; }
        input:focus { border-color: #1a4a7a; outline: none; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        /* 驻转专 专拽 - 专 爪专 拽砖 */
        .btn-container { position: sticky; bottom: 10px; padding: 10px 0; background: white; }
        #submit-btn { 
            width: 100%; 
            padding: 20px; 
            background: #28a745 !important; 
            color: white !important; 
            border: none; 
            border-radius: 12px; 
            font-size: 22px; 
            font-weight: bold; 
            cursor: pointer;
            display: block !important; 
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
            -webkit-appearance: none;
        }
    </style>
</head>
<body>

<div class="card">
    <h2>驻拽转  注拽</h2>
    
    <div class="section-title">1. 驻专  (注 1)</div>
    <div class="grid">
        <div><label>" 住' *</label><input type="text" id="r_no" required></div>
        <div><label> "</label><input type="text" id="r_cancel"></div>
    </div>
    <div class="grid">
        <div><label>拽 驻专拽</label><input type="text" id="p_code"></div>
        <div><label>转专</label><input type="date" id="r_date"></div>
    </div>
    <label>砖 </label><input type="text" id="c_name">
    <label>注 </label><input type="text" id="c_addr">
    <label>爪 拽</label><input type="text" id="c_rep">

    <div class="section-title">2. 驻专 转专 注专转</div>
    <label>砖 转专</label><input type="text" id="s_name">
    <label>转转 转专</label><input type="text" id="s_addr">
    <label>转专 驻专 砖拽</label><input type="text" id="i_desc">
    <label>拽 拽</label><input type="text" id="t_loc">

    <div class="section-title">3. 转  (L, S, S1, S2)</div>
    <div class="grid">
        <div><label>L1 (转)</label><input type="number" id="l1" value="1.50"></div>
        <div><label>L2 (驻)</label><input type="number" id="l2" value="1.50"></div>
    </div>
    <div class="grid">
        <div><label>S 砖 </label><input type="number" id="s_val" value="1.00"></div>
        <div><label>L 驻转 </label><input type="number" id="l_val" value="1.00"></div>
    </div>
    <div class="grid">
        <div><label>S1 (')</label><input type="number" id="s1" value="0.50"></div>
        <div><label>S2 (')</label><input type="number" id="s2" value="0.50"></div>
    </div>

    <div class="section-title">4. 转爪转 拽</div>
    <label>转转</label><select id="v1"><option>转</option><option> 转</option></select>
    <label>专转</label><select id="v2"><option>转</option><option> 转</option></select>
    <label>注专转</label><textarea id="notes" rows="3"></textarea>

    <div class="btn-container">
        <button id="submit-btn" onclick="downloadExcel()"> 驻拽 拽住 注砖</button>
    </div>
</div>

<script>
    // 专转 转专 
    document.getElementById('r_date').valueAsDate = new Date();

    function downloadExcel() {
        const id = document.getElementById('r_no').value;
        if(!id) { alert("拽砖  住驻专 "); return; }

        try {
            const data = [
                ["转注转 拽转 注拽 注驻转 "],
                ["'' 住':", id, "", " '' 住':", document.getElementById('r_cancel').value],
                ["转专:", document.getElementById('r_date').value, "", "拽 驻专拽:", document.getElementById('p_code').value],
                [""],
                ["1. 驻专 拽:"],
                ["砖 :", document.getElementById('c_name').value],
                ["注 :", document.getElementById('c_addr').value, "", "爪:", document.getElementById('c_rep').value],
                [""],
                ["2. 转 :"],
                ["L1 (转):", document.getElementById('l1').value],
                ["L2 (驻):", document.getElementById('l2').value],
                ["S (砖 ):", document.getElementById('s_val').value],
                ["L (驻转 ):", document.getElementById('l_val').value],
                ["S1:", document.getElementById('s1').value, "S2:", document.getElementById('s2').value],
                [""],
                ["3. 转爪转 拽:"],
                ["转转:", document.getElementById('v1').value],
                ["专转:", document.getElementById('v2').value],
                ["注专转:", document.getElementById('notes').value]
            ];

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, " 拽");
            XLSX.writeFile(wb, "Report_" + id + ".xlsx");
        } catch (e) {
            alert("砖: " + e.message);
        }
    }
</script>

</body>
</html>
