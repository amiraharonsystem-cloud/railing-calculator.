<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×“×•×— ××¢×§×” - ×ª"×™ 1142</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <style>
        body { font-family: system-ui, sans-serif; background: #f0f2f5; direction: rtl; padding: 10px; margin: 0; }
        .container { background: white; max-width: 500px; margin: auto; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); overflow: hidden; }
        .head { background: #1a4a7a; color: white; padding: 20px; text-align: center; font-size: 20px; font-weight: bold; }
        .content { padding: 15px; }
        .section { background: #f8f9fa; padding: 10px; margin: 15px 0; border-right: 5px solid #1a4a7a; font-weight: bold; }
        label { display: block; margin: 10px 0 5px; font-size: 14px; font-weight: bold; color: #333; }
        input, select, textarea { width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 10px; font-size: 16px; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        /* ×›×¤×ª×•×¨ ×¢× ×§ ×•×‘×•×œ×˜ */
        .btn-final { 
            width: 100%; padding: 25px; background: #28a745; color: white; border: none; 
            font-size: 24px; font-weight: bold; cursor: pointer; margin-top: 20px;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.1); border-radius: 0 0 15px 15px;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="head">×”×¤×§×ª ×“×•×— ××¢×§×” ×¨×©××™</div>
    
    <div class="content">
        <div class="section">1. ×¤×¨×˜×™ ×× ×”×œ×” (×¢××•×“ 1)</div>
        <div class="grid">
            <div><label>×“×•"×— ××¡' *</label><input type="text" id="r_no"></div>
            <div><label>××‘×˜×œ ×“×•"×—</label><input type="text" id="r_cancel"></div>
        </div>
        <label>×©× ×”××–××™×Ÿ</label><input type="text" id="c_name">
        <label>×§×•×“ ×¤×¨×•×™×§×˜</label><input type="text" id="p_code">
        <label>× ×¦×™×’ ×”××–××™×Ÿ</label><input type="text" id="c_rep">

        <div class="section">2. × ×ª×•× ×™ ×¨×•×— ×•×—×™×©×•×‘</div>
        <label>×‘×—×¨ ×¢×™×¨ (×¨×©×™××” ×§×‘×•×¢×”)</label>
        <select id="city_select">
            <option value="24">×ª×œ ××‘×™×‘-×™×¤×• (24)</option>
            <option value="26">×™×¨×•×©×œ×™× (26)</option>
            <option value="24">×—×™×¤×” (24)</option>
            <option value="24">××©×“×•×“ (24)</option>
            <option value="24">×‘××¨ ×©×‘×¢ (24)</option>
            <option value="24">× ×ª× ×™×” (24)</option>
            <option value="24">×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ (24)</option>
            <option value="24">×¤×ª×— ×ª×§×•×•×” (24)</option>
            <option value="26">×¦×¤×ª / ×”×¨×™× (26)</option>
            <option value="24">××™×œ×ª (24)</option>
        </select>
        
        <div class="grid">
            <div><label>L1 ×—×–×™×ª (×')</label><input type="number" id="l1" value="1.50"></div>
            <div><label>L2 ×¤×™× ×” (×')</label><input type="number" id="l2" value="1.50"></div>
        </div>

        <div class="section">3. × ×ª×•× ×™ ×œ×•×— ××œ×™× (S, L)</div>
        <div class="grid">
            <div><label>S ×©×˜×— ×œ×•×—</label><input type="number" id="s_val" value="1.00"></div>
            <div><label>L ××¤×ª×— ×œ×•×—</label><input type="number" id="l_val" value="1.00"></div>
        </div>
        <div class="grid">
            <div><label>S1 (×')</label><input type="number" id="s1" value="0.00"></div>
            <div><label>S2 (×')</label><input type="number" id="s2" value="0.00"></div>
        </div>

        <div class="section">4. ×ª×•×¦××•×ª ×‘×“×™×§×”</div>
        <label>×¡×˜×˜×•×¡ ×¡×•×¤×™</label>
        <select id="status"><option>××ª××™× âœ…</option><option>×œ× ××ª××™× âŒ</option></select>
        <label>×”×¢×¨×•×ª</label><textarea id="notes" rows="3"></textarea>
    </div>

    <button class="btn-final" onclick="generateExcel()">ğŸ“Š ×”×¤×§ ××§×¡×œ ×¢×›×©×™×•</button>
</div>

<script>
    function generateExcel() {
        const id = document.getElementById('r_no').value;
        if(!id) { alert("×—×•×‘×” ×œ××œ× ××¡×¤×¨ ×“×•×—!"); return; }

        try {
            const vb = document.getElementById('city_select').value;
            const data = [
                ["×ª×¢×•×“×ª ×‘×“×™×§×ª ××¢×§×” ×‘××¢×˜×¤×ª ×”×‘× ×™×™×Ÿ"],
                ["××¡×¤×¨ ×“×•×•×—:", id, "××‘×˜×œ ×“×•×•×—:", document.getElementById('r_cancel').value],
                ["×§×•×“ ×¤×¨×•×™×§×˜:", document.getElementById('p_code').value, "×ª××¨×™×š:", new Date().toLocaleDateString('he-IL')],
                [""],
                ["×¤×¨×˜×™ ×œ×§×•×—:"],
                ["×©× ×”××–××™×Ÿ:", document.getElementById('c_name').value],
                ["× ×¦×™×’:", document.getElementById('c_rep').value],
                [""],
                ["× ×ª×•× ×™ ×—×™×©×•×‘:"],
                ["××”×™×¨×•×ª ×¨×•×— Vb:", vb],
                ["L1:", document.getElementById('l1').value, "L2:", document.getElementById('l2').value],
                ["S ×©×˜×— ×œ×•×—:", document.getElementById('s_val').value, "L ××¤×ª×— ×œ×•×—:", document.getElementById('l_val').value],
                ["S1:", document.getElementById('s1').value, "S2:", document.getElementById('s2').value],
                [""],
                ["×ª×•×¦××” ×¡×•×¤×™×ª:", document.getElementById('status').value],
                ["×”×¢×¨×•×ª:", document.getElementById('notes').value]
            ];

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "×“×•×—");
            XLSX.writeFile(wb, "Report_" + id + ".xlsx");
        } catch (e) {
            alert("×©×’×™××”: " + e.message);
        }
    }
</script>

</body>
</html>
