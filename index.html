<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×“×•×— ××¢×§×” - ×ª"×™ 1142</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #f4f7f6; direction: rtl; padding: 10px; }
        .main-card { background: white; max-width: 600px; margin: auto; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: #1a4a7a; color: white; padding: 20px; text-align: center; }
        .content { padding: 20px; }
        .section-label { background: #eee; padding: 8px; font-weight: bold; margin-top: 20px; border-right: 4px solid #1a4a7a; }
        label { display: block; margin: 12px 0 5px; font-size: 14px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 16px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        /* ×¢×™×¦×•×‘ ×›×¤×ª×•×¨ ×‘×•×œ×˜ ×©×™××™×“ ×™×•×¤×™×¢ */
        .download-btn { 
            display: block; width: 100%; padding: 20px; background: #27ae60; color: white; 
            border: none; border-radius: 0 0 12px 12px; font-size: 20px; font-weight: bold; 
            cursor: pointer; text-align: center; text-decoration: none; margin-top: 20px;
        }
    </style>
</head>
<body>

<div class="main-card">
    <div class="header">
        <h2 style="margin:0;">××¢×¨×›×ª ×”×¤×§×ª ×“×•×—×•×ª ××¢×§×”</h2>
    </div>
    
    <div class="content">
        <div class="section-label">1. ×¤×¨×˜×™ ×”×œ×§×•×— ×•×–×™×”×•×™ (×¢××•×“ 1)</div>
        <div class="grid">
            <div><label>×“×•"×— ××¡' *</label><input type="text" id="r_no" placeholder="×—×•×‘×”"></div>
            <div><label>××‘×˜×œ ×“×•"×— ××¡'</label><input type="text" id="c_no"></div>
        </div>
        <div class="grid">
            <div><label>×§×•×“ ×¤×¨×•×™×§×˜</label><input type="text" id="p_code"></div>
            <div><label>×ª××¨×™×š ×‘×“×™×§×”</label><input type="date" id="r_date"></div>
        </div>
        <label>×©× ×”××–××™×Ÿ</label><input type="text" id="c_name">
        <label>××¢×Ÿ ×”××–××™×Ÿ</label><input type="text" id="c_addr">
        <label>× ×¦×™×’ ×”××–××™×Ÿ ×‘×‘×“×™×§×”</label><input type="text" id="c_rep">

        <div class="section-label">2. ×¤×¨×˜×™ ×”××¢×¨×›×ª ×•×”××ª×¨</div>
        <label>×›×ª×•×‘×ª ×”××ª×¨</label><input type="text" id="s_addr">
        <label>×ª×™××•×¨ ×”×¤×¨×™×˜ ×©× ×‘×“×§</label><input type="text" id="i_desc" placeholder="×œ××©×œ: ××¢×§×” ×“×’× X">
        <label>××™×§×•× ×”×‘×“×™×§×”</label><input type="text" id="t_loc" placeholder="×§×•××”/×“×™×¨×”">
        <label>×¡×•×’ ×‘×“×™×§×”</label>
        <select id="t_type"><option>×¨××©×•× ×”</option><option>×—×•×–×¨×ª</option></select>

        <div class="section-label">3. × ×ª×•× ×™ ××“×™×“×” ×”× ×“×¡×™×™× (S, L, S1, S2)</div>
        <div class="grid">
            <div><label>L1 ×—×–×™×ª (×')</label><input type="number" id="l1" value="1.50" step="0.01"></div>
            <div><label>L2 ×¤×™× ×” (×')</label><input type="number" id="l2" value="1.50" step="0.01"></div>
        </div>
        <div class="grid">
            <div><label>L ××¤×ª×— ×œ×•×— (×')</label><input type="number" id="l_val" value="1.00" step="0.01"></div>
            <div><label>S ×©×˜×— ×œ×•×— (×"×¨)</label><input type="number" id="s_val" value="1.00" step="0.01"></div>
        </div>
        <div class="grid">
            <div><label>S1 (×')</label><input type="number" id="s1" value="0.50" step="0.01"></div>
            <div><label>S2 (×')</label><input type="number" id="s2" value="0.50" step="0.01"></div>
        </div>

        <div class="section-label">4. ×ª×•×¦××•×ª ×•×¡×™×›×•×</div>
        <label>×‘×“×™×§×” ×—×–×•×ª×™×ª</label>
        <select id="v1"><option>××ª××™× âœ…</option><option>×œ× ××ª××™× âŒ</option></select>
        <label>×‘×“×™×§×” ×’×™××•××˜×¨×™×ª</label>
        <select id="v2"><option>××ª××™× âœ…</option><option>×œ× ××ª××™× âŒ</option></select>
        <label>×©×œ××•×ª ×œ×•×— ××œ×™×</label>
        <select id="v3"><option>××ª××™× âœ…</option><option>×œ× ××ª××™× âŒ</option></select>
        <label>×”×¢×¨×•×ª</label>
        <textarea id="notes" rows="3"></textarea>
    </div>

    <button class="download-btn" onclick="generateXLS()">ğŸ“Š ×”×¤×§ ×§×•×‘×¥ ××§×¡×œ</button>
</div>

<script>
    // ×”×’×“×¨×ª ×ª××¨×™×š ×”×™×•× ×›×‘×¨×™×¨×ª ××—×“×œ
    document.getElementById('r_date').valueAsDate = new Date();

    function generateXLS() {
        const id = document.getElementById('r_no').value;
        if(!id) { alert("× × ×œ×”×–×™×Ÿ ××¡×¤×¨ ×“×•×—"); return; }

        try {
            const rows = [
                ["×ª×¢×•×“×ª ×‘×“×™×§×ª ××¢×§×” ×‘××¢×˜×¤×ª ×”×‘× ×™×™×Ÿ"],
                ["××¡' ×“×•×•×—:", id, "", "××‘×˜×œ ×“×•×•×— ××¡':", document.getElementById('c_no').value],
                ["×ª××¨×™×š:", document.getElementById('r_date').value, "", "×§×•×“ ×¤×¨×•×™×§×˜:", document.getElementById('p_code').value],
                [""],
                ["1. ×¤×¨×˜×™ ×”××–××™×Ÿ"],
                ["×©×
