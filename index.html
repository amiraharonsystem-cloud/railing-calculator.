<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×˜×•×¤×¡ ×‘×“×™×§×ª ××¢×§×”</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #f0f4f8; direction: rtl; padding: 10px; }
        .form-card { background: white; max-width: 500px; margin: auto; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #1a4a7a; }
        label { display: block; font-weight: bold; margin-top: 15px; font-size: 14px; }
        input, select, textarea { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .section-title { background: #eef2f7; padding: 8px; margin-top: 20px; font-weight: bold; border-right: 4px solid #1a4a7a; }
        .btn-send { width: 100%; background: #27ae60; color: white; padding: 18px; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; margin-top: 25px; cursor: pointer; }
    </style>
</head>
<body>

<div class="form-card">
    <h2>×ª×¢×•×“×ª ×‘×“×™×§×ª ××¢×§×”</h2>

    <div class="section-title">×¤×¨×˜×™× ×›×œ×œ×™×™×</div>
    <div class="grid">
        <div><label>×“×•"×— ××¡'</label><input type="text" id="r_no"></div>
        <div><label>××‘×˜×œ ×“×•"×—</label><input type="text" id="c_no"></div>
    </div>
    <label>×©× ×”××–××™×Ÿ</label><input type="text" id="c_name">
    <label>×›×ª×•×‘×ª ×”××ª×¨</label><input type="text" id="s_addr">
    <label>×§×•×“ ×¤×¨×•×™×§×˜</label><input type="text" id="p_code">

    <div class="section-title">× ×ª×•× ×™ ××“×™×“×” (×')</div>
    <div class="grid">
        <div><label>L1 (×—×–×™×ª)</label><input type="number" id="l1" value="1.50"></div>
        <div><label>L2 (×¤×™× ×”)</label><input type="number" id="l2" value="1.50"></div>
    </div>
    <div class="grid">
        <div><label>S ×©×˜×— ×œ×•×—</label><input type="number" id="s_val" value="1.00"></div>
        <div><label>L ××¤×ª×— ×œ×•×—</label><input type="number" id="l_val" value="1.00"></div>
    </div>
    <div class="grid">
        <div><label>S1</label><input type="number" id="s1" value="0.00"></div>
        <div><label>S2</label><input type="number" id="s2" value="0.00"></div>
    </div>

    <div class="section-title">× ×ª×•× ×™ ×¢×™×¨ ×•×—×™×©×•×‘</div>
    <label>×‘×—×¨ ×¢×™×¨</label>
    <select id="city">
        <option value="24">×ª×œ ××‘×™×‘-×™×¤×• (24)</option>
        <option value="26">×™×¨×•×©×œ×™× (26)</option>
        <option value="24">×—×™×¤×” (24)</option>
        <option value="24">××©×“×•×“ (24)</option>
        <option value="24">×‘××¨ ×©×‘×¢ (24)</option>
        <option value="24">× ×ª× ×™×” (24)</option>
        <option value="26">×¦×¤×ª (26)</option>
    </select>

    <div class="section-title">×ª×•×¦××•×ª</div>
    <label>×¡×˜×˜×•×¡ ×‘×“×™×§×”</label>
    <select id="v_res"><option>××ª××™× âœ…</option><option>×œ× ××ª××™× âŒ</option></select>
    <label>×”×¢×¨×•×ª</label><textarea id="notes" rows="3"></textarea>

    <button class="btn-send" onclick="exportToExcel()">ğŸ“Š ×”×¤×§ ×§×•×‘×¥ ××§×¡×œ</button>
</div>

<script>
    function exportToExcel() {
        const id = document.getElementById('r_no').value;
        if(!id) { alert("× × ×œ×”×–×™×Ÿ ××¡×¤×¨ ×“×•×—"); return; }

        const rows = [
            ["×ª×¢×•×“×ª ×‘×“×™×§×ª ××¢×§×” ×‘××¢×˜×¤×ª ×”×‘× ×™×™×Ÿ"],
            ["×“×•''×— ××¡':", id, "××‘×˜×œ ×“×•''×—:", document.getElementById('c_no').value],
            ["×ª××¨×™×š:", new Date().toLocaleDateString('he-IL'), "×§×•×“ ×¤×¨×•×™×§×˜:", document.getElementById('p_code').value],
            [""],
            ["×¤×¨×˜×™ ×”××–××™×Ÿ:", document.getElementById('c_name').value],
            ["×›×ª×•×‘×ª ×”××ª×¨:", document.getElementById('s_addr').value],
            [""],
            ["× ×ª×•× ×™ ××“×™×“×”:"],
            ["L1:", document.getElementById('l1').value, "L2:", document.getElementById('l2').value],
            ["S ×©×˜×— ×œ×•×—:", document.getElementById('s_val').value, "L ××¤×ª×— ×œ×•×—:", document.getElementById('l_val').value],
            ["S1:", document.getElementById('s1').value, "S2:", document.getElementById('s2').value],
            [""],
            ["×ª×•×¦××” ×¡×•×¤×™×ª:", document.getElementById('v_res').value],
            ["×”×¢×¨×•×ª:", document.getElementById('notes').value]
        ];

        const ws = XLSX.utils.aoa_to_sheet(rows);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Report");
        XLSX.writeFile(wb, "Report_" + id + ".xlsx");
    }
</script>

</body>
</html>
