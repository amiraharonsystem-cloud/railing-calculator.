<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> 注拽 - 专住转  爪</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <style>
        body { font-family: system-ui, sans-serif; background: #f0f2f5; direction: rtl; padding: 10px; margin: 0; }
        .form-container { background: white; max-width: 500px; margin: auto; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); padding: 20px; border-top: 8px solid #1a4a7a; }
        h2 { text-align: center; color: #1a4a7a; margin-top: 0; }
        .section-h { background: #eef2f7; padding: 10px; font-weight: bold; margin: 20px 0 10px; border-right: 5px solid #1a4a7a; border-radius: 4px; }
        label { display: block; margin: 12px 0 5px; font-size: 14px; font-weight: bold; color: #333; }
        input, select, textarea { width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 10px; font-size: 16px; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .footer-btn { 
            width: 100%; padding: 20px; background: #28a745; color: white; border: none; 
            border-radius: 12px; font-size: 20px; font-weight: bold; cursor: pointer; 
            margin-top: 30px; box-shadow: 0 4px 10px rgba(40,167,69,0.3);
        }
    </style>
</head>
<body>

<div class="form-container">
    <h2>驻拽转  注拽</h2>
    
    <div class="section-h">1. 驻专 </div>
    <div class="grid">
        <div><label>" 住' *</label><input type="text" id="r_no" required></div>
        <div><label> "</label><input type="text" id="r_cancel"></div>
    </div>
    <div class="grid">
        <div><label>拽 驻专拽</label><input type="text" id="p_code"></div>
        <div><label>转专</label><input type="date" id="r_date"></div>
    </div>
    <label>砖 </label><input type="text" id="c_name">
    <label>爪  拽</label><input type="text" id="c_rep">

    <div class="section-h">2. 驻专 转专 注专转</div>
    <label>转转 转专</label><input type="text" id="s_addr">
    <label>转专 驻专 砖拽</label><input type="text" id="i_desc">
    <label>拽 拽</label><input type="text" id="t_loc">

    <div class="section-h">3. 转 砖 注专</div>
    <label>注专 拽</label>
    <select id="city_select">
        <option value="24">转 -驻 (24)</option>
        <option value="26">专砖 (26)</option>
        <option value="24">驻 (24)</option>
        <option value="24">砖 (24)</option>
        <option value="24">专 砖注 (24)</option>
        <option value="26">爪驻转 (26)</option>
        <option value="24">转 (24)</option>
    </select>
    <div class="grid">
        <div><label>L1 转 (')</label><input type="number" id="l1" value="1.50" step="0.01"></div>
        <div><label>L2 驻 (')</label><input type="number" id="l2" value="1.50" step="0.01"></div>
    </div>
    <div class="grid">
        <div><label>S 砖 </label><input type="number" id="s_val" value="1.00" step="0.01"></div>
        <div><label>L 驻转 </label><input type="number" id="l_val" value="1.00" step="0.01"></div>
    </div>
    <div class="grid">
        <div><label>S1 (')</label><input type="number" id="s1" value="0.50" step="0.01"></div>
        <div><label>S2 (')</label><input type="number" id="s2" value="0.50" step="0.01"></div>
    </div>

    <div class="section-h">4. 转爪转 住</div>
    <label>拽 转转</label>
    <select id="v1"><option>转</option><option> 转</option></select>
    <label>拽 专转</label>
    <select id="v2"><option>转</option><option> 转</option></select>
    <label>注专转</label>
    <textarea id="notes" rows="3"></textarea>

    <button class="footer-btn" onclick="generateExcel()"> 驻拽 拽住 注砖</button>
</div>

<script>
    document.getElementById('r_date').valueAsDate = new Date();

    function generateExcel() {
        const id = document.getElementById('r_no').value;
        if(!id) { alert("  住驻专 !"); return; }

        const vb = document.getElementById('city_select').value;
        const l1 = parseFloat(document.getElementById('l1').value);
        const l2 = parseFloat(document.getElementById('l2').value);
        
        // 砖 注住 (拽转 住住)
        const Fser = Math.ceil(Math.max(850, 750 + (vb * 1.5)));

        const data = [
            ["转注转 拽转 注拽 注驻转 "],
            ["住' :", id, "  住':", document.getElementById('r_cancel').value],
            ["拽 驻专拽:", document.getElementById('p_code').value, "转专:", document.getElementById('r_date').value],
            [""],
            ["1. 驻专  转专"],
            ["砖 :", document.getElementById('c_name').value],
            ["爪:", document.getElementById('c_rep').value],
            ["转转 转专:", document.getElementById('s_addr').value],
            ["转专 驻专:", document.getElementById('i_desc').value],
            ["拽 拽:", document.getElementById('t_loc').value],
            [""],
            ["2. 转  砖"],
            ["专转 专 Vb:", vb],
            ["L1 (转):", l1], ["L2 (驻):", l2],
            ["S 砖 :", document.getElementById('s_val').value], 
            ["L 驻转 :", document.getElementById('l_val').value],
            ["S1:", document.getElementById('s1').value], ["S2:", document.getElementById('s2').value],
            [""],
            ["3. 转爪转 拽"],
            ["转转:", document.getElementById('v1').value],
            ["专转:", document.getElementById('v2').value],
            ["注住 爪 砖:", Math.ceil(Fser * l1 * 0.75)],
            ["注专转:", document.getElementById('notes').value]
        ];

        const ws = XLSX.utils.aoa_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "");
        XLSX.writeFile(wb, "Report_" + id + ".xlsx");
    }
</script>

</body>
</html>
