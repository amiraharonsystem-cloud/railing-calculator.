<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>驻拽  注拽 专砖</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --blue: #1a4a7a; --bg: #f8f9fa; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 10px; direction: rtl; }
        .card { background: white; max-width: 600px; margin: auto; padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-top: 10px solid var(--blue); }
        h2 { text-align: center; color: var(--blue); margin-top: 0; }
        .row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 10px; }
        .field { margin-bottom: 15px; }
        label { display: block; font-weight: bold; font-size: 14px; margin-bottom: 5px; color: #333; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        .section-h { background: #eee; padding: 8px; font-weight: bold; margin: 20px 0 10px; border-right: 5px solid var(--blue); }
        .btn { width: 100%; padding: 20px; background: #27ae60; color: white; border: none; border-radius: 10px; font-size: 20px; font-weight: bold; cursor: pointer; margin-top: 15px; }
    </style>
</head>
<body>

<div class="card">
    <h2>转注转 拽转 注拽 - 转" 1142</h2>
    
    <div class="section-h">1. 驻专 拽 </div>
    <div class="row">
        <div class="field"><label>" 住' *</label><input type="text" id="rep_id"></div>
        <div class="field"><label>住 拽</label><select id="t_type"><option>专砖</option><option>专转</option></select></div>
    </div>
    <div class="field"><label>砖 </label><input type="text" id="client"></div>
    <div class="field"><label>转转 转专</label><input type="text" id="addr"></div>

    <div class="section-h">2. 驻专 注 注专转 (砖 ')</div>
    <div class="field"><label>转专 驻专 砖拽</label><input type="text" id="p_desc" placeholder="砖: 注拽 转"></div>
    <div class="row">
        <div class="field"><label>砖  S ("专)</label><input type="number" id="s_area" value="1.00"></div>
        <div class="field"><label>驻转  L (')</label><input type="number" id="l_width" value="1.00"></div>
    </div>
    <div class="row">
        <div class="field"><label>S1 (')</label><input type="number" id="s1" value="0.00"></div>
        <div class="field"><label>S2 (')</label><input type="number" id="s2" value="0.00"></div>
    </div>

    <div class="section-h">3. 转 转 (砖 ')</div>
    <div class="field"><label>注专 拽</label>
        <select id="city_sel">
            <option value="24">转 -驻 (24)</option>
            <option value="26">专砖 (26)</option>
            <option value="24">驻 (24)</option>
            <option value="24">砖 (24)</option>
            <option value="24">专 砖注 (24)</option>
        </select>
    </div>
    <div class="row">
        <div class="field"><label>L1 转 (')</label><input type="number" id="l1" value="1.50"></div>
        <div class="field"><label>L2 驻 (')</label><input type="number" id="l2" value="1.50"></div>
    </div>

    <button class="btn" onclick="generatePerfectExcel()"> 驻拽 拽住  拽专</button>
</div>

<script>
    function generatePerfectExcel() {
        const rid = document.getElementById('rep_id').value;
        if(!rid) return alert(" 住驻专 ");

        const vb = parseFloat(document.getElementById('city_sel').value);
        const l1 = parseFloat(document.getElementById('l1').value);
        const l2 = parseFloat(document.getElementById('l2').value);
        
        // 砖 注住 砖专转 (Fser) 驻 拽转 砖 '
        const Fser = Math.ceil(Math.max(850, 750 + (vb * 1.5))); 

        // 爪专转 注专 砖专转 拽 驻  砖 拽抓 砖注转
        const data = [
            ["转注转 拽转 注拽 注驻转 "],
            ["", "", "住'", rid, "", "", "转专 拽:", new Date().toLocaleDateString('he-IL')],
            ["1. 驻专 拽  :"],
            ["砖 :", document
