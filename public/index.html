<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>注专转 驻拽转 转 注拽 -  </title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 10px; direction: rtl; }
        .form-card { max-width: 850px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .section { border: 1px solid #007bff; padding: 15px; border-radius: 8px; margin-bottom: 20px; background: #fff; }
        .section-title { font-weight: bold; color: #007bff; background: #eef6ff; padding: 5px 15px; margin: -15px -15px 15px -15px; border-radius: 8px 8px 0 0; display: block; border-bottom: 1px solid #007bff; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        label { display: block; margin-top: 10px; font-weight: bold; font-size: 13px; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; font-size: 15px; }
        button { width: 100%; padding: 20px; background: #28a745; color: white; border: none; border-radius: 10px; font-size: 22px; font-weight: bold; cursor: pointer; margin-top: 20px; }
        .tech-info { font-style: italic; color: #666; font-size: 12px; }
    </style>
</head>
<body>

<div class="form-card">
    <h2 style="text-align:center;">转注转 拽转 注拽 -  </h2>

    <div class="section">
        <span class="section-title">驻专 转专转</span>
        <div class="grid">
            <div><label>转专 拽</label><input type="date" id="testDate"></div>
            <div><label>拽 驻专拽</label><input type="text" id="projectId"></div>
            <div style="grid-column: span 2;"><label>砖 转专</label><input type="text" id="siteName"></div>
        </div>
    </div>

    <div class="section">
        <span class="section-title">1. 驻专 拽  </span>
        <div class="grid">
            <div><label>砖 </label><input type="text" id="clientName"></div>
            <div><label>爪 </label><input type="text" id="clientRep"></div>
        </div>
        <label>转转 转专</label><input type="text" id="siteAddress">
        <label>转专 </label><input type="text" id="structure">
        <label>转专 驻专 砖拽</label><input type="text" id="itemDesc">
        <label>拽 拽</label><input type="text" id="location">
        <div class="grid">
            <div><label>转 注拽</label><select id="planningStatus"><option> 砖</option><option>砖</option></select></div>
            <div><label>砖 住</label><select id="calculationStatus"><option> 砖</option><option>砖</option></select></div>
        </div>
    </div>

    <div class="section">
        <span class="section-title">2. 转 专 (转 专)</span>
        <div class="grid">
            <div><label>L1 - 专拽  爪</label><input type="text" id="L1"></div>
            <div><label>L2 - 驻转 砖 住</label><input type="text" id="L2"></div>
            <div style="grid-column: span 2;"><label>L - 驻转  </label><input type="text" id="L_fill"></div>
        </div>
    </div>

    <div class="section">
        <span class="section-title">3. 注住 专 ('/"专)</span>
        <div class="grid">
            <div><label>ws (注住 专)</label><input type="text" id="ws"></div>
            <div><label>0.5ws (爪 注住)</label><input type="text" id="halfWs"></div>
        </div>
    </div>

    <div class="section">
        <span class="section-title">4. 转爪转 拽 (转" 1142)</span>
        <label>住注祝 10.3.3 (注住 专)</label><input type="text" id="res1033">
        <label>住注祝 10.3.4 (注住 驻拽)</label><input type="text" id="res1034">
        <label>住注祝 10.3.5 ( )</label><input type="text" id="res1035">
    </div>

    <div class="section">
        <span class="section-title">5. 注专转 转</span>
        <label>注专转 拽</label><textarea id="comments" rows="3"></textarea>
        <label>砖 拽</label><input type="text" id="inspectorName">
    </div>

    <button onclick="generate()"> 驻拽 " 拽住 </button>
</div>

<script>
    async function generate() {
        const data = {};
        document.querySelectorAll('input, select, textarea').forEach(el => data[el.id] = el.value);
        const btn = document.querySelector('button');
        btn.innerText = "注 转..."; btn.disabled = true;

        try {
            const response = await fetch('/generate-excel', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            if (response.ok) {
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Report_${data.projectId}.xlsx`;
                a.click();
            } else { alert("转拽:  砖拽抓 template.xlsx 爪 -GitHub"); }
        } catch (e) { alert("砖 专"); }
        btn.innerText = " 驻拽 " 拽住 "; btn.disabled = false;
    }
</script>
</body>
</html>
