<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>注专转 " 注 转" 1142</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; direction: rtl; padding: 20px; }
        .container { max-width: 900px; margin: auto; background: white; padding: 20px; border-radius: 5px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .section { background: #eee; padding: 10px; margin: 15px 0; font-weight: bold; border-right: 5px solid #2c3e50; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        label { font-size: 13px; color: #333; }
        input, select { width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 3px; }
        .btn { background: #27ae60; color: white; border: none; padding: 15px; width: 100%; cursor: pointer; font-size: 18px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>转 转 拽 - 转" 1142</h2>

    <div class="section">1. 驻专 </div>
    <div class="grid">
        <div><label>砖 </label><input id="clientName"></div>
        <div><label>爪 </label><input id="presenterName"></div>
        <div><label>转专 拽</label><input type="date" id="testDate"></div>
        <div><label>拽 驻专拽</label><input id="projectId"></div>
    </div>

    <div class="section">2. 转 专 (住注祝 80-85)</div>
    <div class="grid">
        <div><label>抓 专 住住 (qb)</label><input id="qb"></div>
        <div><label>拽 砖驻 (Ce)</label><input id="ce_z"></div>
        <div><label>抓 转 (we)</label><input id="we_design"></div>
    </div>

    <div class="section">3. 注住 砖 (P, Fser, L1, L2)</div>
    <div class="grid">
        <div><label>Fser (拽"/')</label><input id="Fser"></div>
        <div><label>L1 - 专拽  爪</label><input id="L1"></div>
        <div><label>L2 - 驻转 砖 住</label><input id="L2"></div>
        <div><label>P - 注住 砖</label><input id="P_calc"></div>
    </div>

    <div class="section">4. 转爪转 住</div>
    <table width="100%" border="1" style="border-collapse: collapse; text-align: center;">
        <tr><th>住注祝</th><th>转 I</th><th>砖专转 J</th><th>住拽</th></tr>
        <tr><td>10.3.4 '</td><td><input id="hor_a"></td><td><input id="res_a"></td><td><select id="stat_a"><option>注</option><option> 注</option></select></td></tr>
        <tr><td>10.3.5 '</td><td><input id="hor_c"></td><td><input id="res_c"></td><td><select id="stat_c"><option>注</option><option> 注</option></select></td></tr>
    </table>

    <br>
    <button class="btn" onclick="generate()"> 驻拽 拽住  -Render</button>
</div>

<script>
    async function generate() {
        const d = {};
        document.querySelectorAll('input, select').forEach(el => d[el.id] = el.value);
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(d)
        });
        const blob = await res.blob();
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "Final_Report.xlsx";
        a.click();
    }
</script>
</body>
</html>
