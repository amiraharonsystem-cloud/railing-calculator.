<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title> 转" 1142 - 注转拽 拽专 </title>
    <style>
        :root { --excel-green: #217346; --border-color: #bbb; --header-bg: #f3f3f3; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #455a64; margin: 0; padding: 20px; }
        .excel-container { background: white; max-width: 1400px; margin: auto; border: 1px solid #000; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        .header-title { text-align: center; color: #1a237e; border-bottom: 3px solid var(--excel-green); padding-bottom: 10px; margin-bottom: 20px; }
        
        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        th, td { border: 1px solid var(--border-color); height: 28px; padding: 0 5px; font-size: 13px; vertical-align: middle; }
        
        /* Excel-like Header Styling */
        .row-num { background: var(--header-bg); width: 40px; text-align: center; color: #666; font-size: 11px; font-weight: normal; }
        .col-header { background: var(--header-bg); text-align: center; font-weight: normal; height: 22px; }
        
        .section-bar { background: #1a237e; color: white; font-weight: bold; padding: 6px 15px; }
        .label-cell { background: #fafafa; font-weight: bold; text-align: right; }
        
        input, select { width: 100%; height: 100%; border: none; outline: none; background: transparent; font-size: 13px; }
        input:focus { background: #fffde7; outline: 1px solid var(--excel-green); }
        
        .sticky-footer { position: sticky; bottom: 0; background: #fff; padding: 20px; text-align: center; border-top: 3px solid var(--excel-green); margin-top: 30px; }
        .submit-btn { background: var(--excel-green); color: white; border: none; padding: 15px 120px; font-size: 22px; font-weight: bold; cursor: pointer; border-radius: 3px; }
    </style>
</head>
<body>

<div class="excel-container">
    <div class="header-title"><h1> 注 转" 1142 - 驻专住  1:1</h1></div>

    <table>
        <tr>
            <th class="row-num"></th>
            <th class="col-header">C</th><th class="col-header">D</th><th class="col-header">F</th>
            <th class="col-header">G</th><th class="col-header">H</th><th class="col-header">I</th>
            <th class="col-header">J</th><th class="col-header">K</th><th class="col-header">L</th>
        </tr>

        <tr><td class="row-num">1</td><td colspan="9" class="section-bar">驻专  </td></tr>
        <tr>
            <td class="row-num">2</td><td class="label-cell">住驻专  (H2)</td><td colspan="3"><input data-addr="H2"></td>
            <td class="label-cell">转专 (L3)</td><td colspan="4"><input data-addr="L3" type="date"></td>
        </tr>
        <tr>
            <td class="row-num">4</td><td class="label-cell">砖 转专 (C4)</td><td colspan="3"><input data-addr="C4"></td>
            <td class="label-cell">拽 驻专拽 (L4)</td><td colspan="4"><input data-addr="L4"></td>
        </tr>

        <tr><td class="row-num">40</td><td colspan="9" class="section-bar">转专 注拽 驻专 专 ( 注)</td></tr>
        <tr>
            <th class="row-num">#</th><th colspan="2">转专 专</th><th>专 (C)</th><th>专 (F)</th><th>专砖转 转拽 (H)</th><th colspan="4">住拽 (L)</th>
        </tr>
        <tr>
            <td class="row-num">45</td><td colspan="2" class="label-cell">驻专驻 爪</td>
            <td><input data-addr="C45"></td><td><input data-addr="F45"></td><td><input data-addr="H45"></td>
            <td colspan="4">
                <select data-addr="L45">
                    <option value=""></option><option value="转">转</option><option value=" 转"> 转</option>
                </select>
            </td>
        </tr>
        <tr>
            <td class="row-num">70</td><td colspan="2" class="label-cell">转</td>
            <td><input data-addr="G70"></td><td>注: <input data-addr="G67"></td><td><input data-addr="H70"></td>
            <td colspan="4"><select data-addr="L70"><option value=""></option><option value="转">转</option></select></td>
        </tr>

        <tr><td class="row-num">79</td><td colspan="9" class="section-bar">转 注住 专 - Fw (砖专转 80-85)</td></tr>
        <tr>
            <td class="row-num">84</td><td class="label-cell">qb (F84)</td><td><input data-addr="F84"></td>
            <td class="label-cell">Ce (K84)</td><td><input data-addr="K84"></td>
            <td class="label-cell">CsCd (L84)</td><td><input data-addr="L84"></td>
            <td class="label-cell">Cf (M84)</td><td><input data-addr="M84"></td>
            <td class="label-cell" style="background:#e8f5e9">Fw (I84)</td><td><input data-addr="I84"></td>
        </tr>

        <tr><td class="row-num">100</td><td colspan="9" class="section-bar">转爪转 拽转 注住 驻拽 (10.3.4)</td></tr>
        <tr>
            <th class="row-num">#</th><th>住注祝</th><th>住</th><th>注住 (G)</th><th>转 (I)</th><th>砖专转 (J)</th><th>专砖 (K)</th><th colspan="3">住拽 (L)</th>
        </tr>
        <tr>
            <td class="row-num">107</td><td>10.3.4 '</td><td>砖专转</td>
            <td><input data-addr="G107"></td><td><input data-addr="I107"></td><td><input data-addr="J107"></td><td><input data-addr="K107"></td>
            <td colspan="3"><select data-addr="L107"><option value=""></option><option value="转">转</option><option value=" 转"> 转</option></select></td>
        </tr>
        <tr>
            <td class="row-num">111</td><td>10.3.4 '</td><td>爪</td>
            <td><input data-addr="G111"></td><td><input data-addr="I111"></td><td><input data-addr="J111"></td><td><input data-addr="K111"></td>
            <td colspan="3"><select data-addr="L111"><option value=""></option><option value="转">转</option></select></td>
        </tr>

        <tr><td class="row-num">127</td><td colspan="9" class="section-bar"> 住 (砖专转 127-138)</td></tr>
        <tr>
            <td class="row-num">132</td><td class="label-cell"> (132)</td>
            <td colspan="2">砖 S: <input data-addr="I127"></td>
            <td colspan="2">转爪: <input data-addr="I132"></td>
            <td colspan="2">专砖: <input data-addr="K132"></td>
            <td><select data-addr="L133"><option value=""></option><option value="转">转</option></select></td>
        </tr>
        <tr>
            <td class="row-num">137</td><td class="label-cell">转转</td>
            <td colspan="6"><input data-addr="I137" placeholder="驻专 爪 转..."></td>
            <td colspan="2"><select data-addr="L138"><option value=""></option><option value="转">转</option><option value=" 转"> 转</option></select></td>
        </tr>
    </table>

    <div class="sticky-footer">
        <button class="submit-btn" onclick="generateExcel()"> 驻拽  拽住 住驻 (1:1)</button>
    </div>
</div>

<script>
    async function generateExcel() {
        const cells = {};
        document.querySelectorAll('[data-addr]').forEach(el => {
            cells[el.getAttribute('data-addr')] = el.value;
        });

        const response = await fetch('/generate-excel', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ cells })
        });

        if (response.ok) {
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "TI_1142_Full_Report.xlsx";
            a.click();
        } else {
            alert("砖 驻拽转 拽抓");
        }
    }
</script>
</body>
</html>
