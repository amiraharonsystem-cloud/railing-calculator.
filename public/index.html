<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>注专转 1142 -  住 </title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Assistant', sans-serif; background: #f0f4f8; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 1200px; margin: auto; }
        .header { text-align: center; margin-bottom: 40px; background: #fff; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .header h1 { color: #1a73e8; margin: 0; font-size: 2.2rem; }
        
        .card { background: white; border-radius: 12px; padding: 25px; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .card-h { font-size: 1.4rem; font-weight: 700; color: #1565c0; border-bottom: 2px solid #e3f2fd; padding-bottom: 10px; margin-bottom: 20px; }
        
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; }
        .field { display: flex; flex-direction: column; }
        .field.wide { grid-column: span 2; }
        .field.full { grid-column: span 4; }
        
        label { font-weight: 600; font-size: 1rem; margin-bottom: 5px; color: #555; }
        input, select, textarea { padding: 10px; border: 1.5px solid #ced4da; border-radius: 6px; font-size: 1rem; outline: none; transition: 0.2s; }
        input:focus { border-color: #1a73e8; box-shadow: 0 0 0 3px rgba(26,115,232,0.1); }
        
        .sub-h { grid-column: span 4; background: #f8f9fa; padding: 8px 12px; border-right: 4px solid #1a73e8; font-weight: bold; margin-top: 10px; }
        
        .footer { position: sticky; bottom: 20px; text-align: center; padding: 20px; z-index: 100; }
        .btn { background: #2e7d32; color: white; padding: 15px 60px; font-size: 1.3rem; font-weight: 700; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 4px 20px rgba(46,125,50,0.4); }
        .btn:hover { background: #1b5e20; transform: scale(1.02); }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>转 转 - 转" 1142</h1>
        <p>  拽  驻拽 拽住 拽专</p>
    </div>

    <div class="card">
        <div class="card-h">1. 驻专   (砖专转 1-15)</div>
        <div class="grid">
            <div class="field"><label>住驻专 " (H2)</label><input data-addr="H2"></div>
            <div class="field"><label>转专 (L3)</label><input data-addr="L3" type="date"></div>
            <div class="field wide"><label>砖 转专 (C4)</label><input data-addr="C4"></div>
            <div class="field"><label>拽 驻专拽 (L4)</label><input data-addr="L4"></div>
            <div class="field wide"><label>砖  (C7)</label><input data-addr="C7"></div>
            <div class="field wide"><label>注  (I7)</label><input data-addr="I7"></div>
        </div>
    </div>

    <div class="card">
        <div class="card-h">2. 驻专 转拽 爪 拽 (砖专转 16-38)</div>
        <div class="grid">
            <div class="field wide"><label>砖 转拽 (C17)</label><input data-addr="C17"></div>
            <div class="field wide"><label>注 转拽 (I17)</label><input data-addr="I17"></div>
            <div class="sub-h">爪 </div>
            <div class="field"><label>  (C34)</label><input data-addr="C34"></div>
            <div class="field"><label>住驻专 砖专 (F34)</label><input data-addr="F34"></div>
            <div class="field"><label>转拽祝  (L34)</label><input data-addr="L34" type="date"></div>
            <div class="field"><label> 转 (C36)</label><input data-addr="C36"></div>
        </div>
    </div>

    <div class="card">
        <div class="card-h">3. 转专 注拽 驻专 (砖专转 40-78)</div>
        <div class="grid">
            <div class="sub-h">驻专驻 爪</div>
            <div class="field"><label>专 (C45)</label><input data-addr="C45"></div>
            <div class="field"><label>专 (F45)</label><input data-addr="F45"></div>
            <div class="field"><label>专砖 (H45)</label><input data-addr="H45"></div>
            <div class="field"><label>住拽</label>
                <select data-addr="L45"><option value="转">转</option><option value=" 转"> 转</option></select>
            </div>
            <div class="sub-h">转</div>
            <div class="field wide"><label>住 注 (G70)</label><input data-addr="G70"></div>
            <div class="field"><label>注 (G67)</label><input data-addr="G67"></div>
            <div class="field"><label>住拽</label><select data-addr="L70"><option>转</option></select></div>
        </div>
    </div>

    <div class="card">
        <div class="card-h">4. 砖 注住 专 Fw (砖专转 80-85)</div>
        <div class="grid">
            <div class="field"><label>qb (F84)</label><input data-addr="F84"></div>
            <div class="field"><label>Ce (K84)</label><input data-addr="K84"></div>
            <div class="field"><label>CsCd (L84)</label><input data-addr="L84"></div>
            <div class="field"><label>Cf (M84)</label><input data-addr="M84"></div>
            <div class="field wide"><label>We (I82) [N/m虏]</label><input data-addr="I82"></div>
            <div class="field wide"><label>Fw (I84) [N]</label><input data-addr="I84" style="background: #e8f0fe; font-weight: bold;"></div>
        </div>
    </div>

    <div class="card">
        <div class="card-h">5. 转爪转 拽 (10.3.4) -  住注驻</div>
        <div class="grid">
            <div class="sub-h">10.3.4 ' - 注住 驻拽 砖专转</div>
            <div class="field"><label>注住 G (G107)</label><input data-addr="G107"></div>
            <div class="field"><label>转 I (I107)</label><input data-addr="I107"></div>
            <div class="field"><label>砖专转 J (J107)</label><input data-addr="J107"></div>
            <div class="field"><label>住拽 (L107)</label><select data-addr="L107"><option>转</option><option> 转</option></select></div>
            
            <div class="sub-h">10.3.4 ' - 注住 爪 (111)</div>
            <div class="field"><label>注住 (G111)</label><input data-addr="G111"></div>
            <div class="field"><label>转 (I111)</label><input data-addr="I111"></div>
            <div class="field"><label>住拽 (L111)</label><select data-addr="L111"><option>转</option></select></div>
            
            <div class="sub-h">10.3.4 ' - 注住 砖 (113)</div>
            <div class="field"><label>注住 (G113)</label><input data-addr="G113"></div>
            <div class="field"><label>砖专转 (J113)</label><input data-addr="J113"></div>
            <div class="field"><label>住拽 (L113)</label><select data-addr="L113"><option>转</option></select></div>
        </div>
    </div>

    <div class="card">
        <div class="card-h">6.  住 (砖专转 127-138)</div>
        <div class="grid">
            <div class="field"><label>砖 S (I127)</label><input data-addr="I127"></div>
            <div class="field"><label>转爪 (I132)</label><input data-addr="I132"></div>
            <div class="field"><label>专砖 (K132)</label><input data-addr="K132"></div>
            <div class="field"><label>住拽 </label><select data-addr="L133"><option>转</option></select></div>
            
            <div class="field full"><label>爪 转 (I137)</label><textarea data-addr="I137" rows="3"></textarea></div>
            <div class="field wide"><label>住拽 住驻转 (L138)</label>
                <select data-addr="L138" style="background:#e8f5e9; font-weight: bold;">
                    <option value="转">注 专砖转 转拽</option>
                    <option value=" 转"> 注 专砖转</option>
                </select>
            </div>
        </div>
    </div>

    <div class="footer">
        <button class="btn" onclick="generate()"> 驻拽 拽住 住  (100%)</button>
    </div>
</div>

<script>
    async function generate() {
        const cells = {};
        document.querySelectorAll('[data-addr]').forEach(el => cells[el.getAttribute('data-addr')] = el.value);
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ cells })
        });
        if(res.ok) {
            const blob = await res.blob();
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `Report_Full_1142_${new Date().toLocaleDateString()}.xlsx`;
            a.click();
        }
    }
</script>
</body>
</html>
