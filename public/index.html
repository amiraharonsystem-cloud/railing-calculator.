<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial; padding: 20px; direction: rtl; }
        .grid { display: grid; grid-template-columns: 200px 1fr; gap: 10px; max-width: 800px; margin: auto; }
        input { padding: 8px; border: 1px solid #000; }
        .header { background: #eee; padding: 10px; font-weight: bold; grid-column: span 2; border: 1px solid #000; margin-top: 15px; }
        button { grid-column: span 2; padding: 20px; background: #000; color: #fff; font-size: 20px; cursor: pointer; margin-top: 20px; }
    </style>
</head>
<body>

<div class="grid">
    <div class="header">פרטי הדו"ח (שורות 2-10)</div>
    <label>מספר דו"ח (H2):</label><input id="H2">
    <label>תאריך (L3):</label><input id="L3">
    <label>שם האתר (C4):</label><input id="C4">
    <label>קוד פרויקט (L4):</label><input id="L4">
    <label>שם המזמין (C7):</label><input id="C7">
    <label>כתובת (C8):</label><input id="C8">

    <div class="header">מפרט טכני וברגים (שורות 45-78)</div>
    <label>סוג פרופיל (C45):</label><input id="C45">
    <label>גמר (F45):</label><input id="F45">
    <label>סוג עיגון (C47):</label><input id="C47">
    <label>תיאור עיגון (I47):</label><input id="I47">
    <label>ברגים (C49):</label><input id="C49">
    <label>מסעד יד (C55):</label><input id="C55">
    <label>עובי זכוכית (I67):</label><input id="I67">
    <label>סוג זכוכית (I70):</label><input id="I70">

    <div class="header">נתוני עומס וחישוב (שורות 19-32)</div>
    <label>Fser (L19):</label><input id="L19">
    <label>P מחושב (L20):</label><input id="L20">
    <label>L1 (L22):</label><input id="L22">
    <label>We רוח (I32):</label><input id="I32">
    <label>Ws סה"כ (L32):</label><input id="L32">

    <div class="header">תוצאות (שורות 107-116)</div>
    <label>תזוזה אופקית (I107):</label><input id="I107">
    <label>שיורית (J107):</label><input id="J107">
    <label>מסקנה (L107):</label><input id="L107">

    <button onclick="save()">הפק אקסל - העתק מדויק של התאים</button>
</div>

<script>
    async function save() {
        const data = {};
        document.querySelectorAll('input').forEach(i => data[i.id] = i.value);
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(data)
        });
        const blob = await res.blob();
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "Railing_Report.xlsx";
        a.click();
    }
</script>

</body>
</html>
