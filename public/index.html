<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>注专转 住转 转" 1142 - 驻专住 </title>
    <style>
        :root { --blue: #1a237e; --gray: #f5f5f5; --border: #999; --gold: #ffa000; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #37474f; margin: 0; padding: 20px; }
        .excel-sheet { background: white; max-width: 1400px; margin: auto; padding: 40px; border: 1px solid #000; box-shadow: 0 0 50px rgba(0,0,0,0.6); }
        .header-title { text-align: center; color: var(--blue); border-bottom: 4px solid var(--gold); padding-bottom: 15px; margin-bottom: 30px; }
        
        .section-h { background: var(--blue); color: white; padding: 10px; font-weight: bold; margin-top: 25px; border: 1px solid #000; }
        table { width: 100%; border-collapse: collapse; margin-top: -1px; }
        th, td { border: 1px solid var(--border); padding: 6px; text-align: center; font-size: 13px; }
        th { background: var(--gray); font-weight: bold; }
        .row-num { background: #eee; width: 40px; color: #666; font-size: 11px; font-weight: normal; }
        .label-cell { text-align: right; background: #fafafa; font-weight: bold; width: 180px; }
        
        input, select, textarea { width: 100%; border: 1px solid transparent; background: transparent; padding: 4px; box-sizing: border-box; font-size: 14px; }
        input:focus { background: #fffde7; border: 1px solid var(--gold); outline: none; }
        
        .action-bar { position: sticky; bottom: 0; background: rgba(255,255,255,0.95); padding: 25px; border-top: 5px solid var(--blue); text-align: center; margin-top: 50px; }
        .btn-submit { background: #2e7d32; color: white; padding: 20px 150px; font-size: 26px; border: none; cursor: pointer; border-radius: 4px; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
    </style>
</head>
<body>

<div class="excel-sheet">
    <div class="header-title"><h1> 拽转 注拽 转" 1142 - 注转拽  </h1></div>

    <div class="section-h">1. 驻专   (砖专转 1-30)</div>
    <table>
        <tr>
            <td class="row-num">2</td><td class="label-cell">住驻专 ":</td><td><input data-addr="H2"></td>
            <td class="row-num">3</td><td class="label-cell">转专 拽:</td><td><input data-addr="L3" type="date"></td>
        </tr>
        <tr>
            <td class="row-num">4</td><td class="label-cell">砖 转专:</td><td><input data-addr="C4"></td>
            <td class="row-num">4</td><td class="label-cell">拽 驻专拽:</td><td><input data-addr="L4"></td>
        </tr>
        <tr>
            <td class="row-num">7</td><td class="label-cell">砖 :</td><td><input data-addr="C7"></td>
            <td class="row-num">7</td><td class="label-cell">注 :</td><td><input data-addr="I7"></td>
        </tr>
    </table>

    <div class="section-h">2. 驻专  砖 专 (砖专转 45-85)</div>
    <table>
        <tr>
            <th>砖专</th><th>转专 专</th><th>专 (C)</th><th>专 (F/I)</th><th>专砖转 转拽 (H)</th><th>住拽 (L)</th>
        </tr>
        <tr>
            <td class="row-num">45</td><td class="label-cell">驻专驻 爪</td>
            <td><input data-addr="C45"></td><td><input data-addr="F45"></td><td><input data-addr="H45" value="驻 转"></td>
            <td><select data-addr="L45"><option value="转">转</option><option value=" 转"> 转</option></select></td>
        </tr>
        <tr>
            <td class="row-num">70</td><td class="label-cell">转</td>
            <td><input data-addr="G70"></td><td>注: <input data-addr="G67"></td><td><input data-addr="H70"></td>
            <td><select data-addr="L70"><option value="转">转</option></select></td>
        </tr>
    </table>

    <div style="font-weight:bold; margin-top:15px; color:var(--blue);">拽 注住 专 (Fw Analysis):</div>
    <table>
        <tr>
            <th>qb (F84)</th><th>Ce (K84)</th><th>CsCd (L84)</th><th>Cf (M84)</th><th>We (I82) [N/m虏]</th><th>Fw (I84) [N]</th>
        </tr>
        <tr>
            <td><input data-addr="F84"></td><td><input data-addr="K84"></td><td><input data-addr="L84"></td>
            <td><input data-addr="M84"></td><td><input data-addr="I82"></td><td><input data-addr="I84"></td>
        </tr>
    </table>

    <div class="section-h">3. 转爪转 拽转 注住 (砖专转 100-117)</div>
    <table>
        <tr>
            <th>砖专</th><th>住注祝 拽</th><th>注住 N (G)</th><th>转 I (")</th><th>砖专转 J (")</th><th>专砖 (K)</th><th>住拽 (L)</th>
        </tr>
        <tr>
            <td class="row-num">107</td><td class="label-cell">10.3.4 ' (砖专转)</td>
            <td><input data-addr="G107"></td><td><input data-addr="I107"></td><td><input data-addr="J107"></td><td><input data-addr="K107"></td>
            <td><select data-addr="L107"><option value="转">转</option><option value=" 转"> 转</option></select></td>
        </tr>
        <tr>
            <td class="row-num">111</td><td class="label-cell">10.3.4 ' (爪)</td>
            <td><input data-addr="G111"></td><td><input data-addr="I111"></td><td><input data-addr="J111"></td><td><input data-addr="K111"></td>
            <td><select data-addr="L111"><option value="转">转</option></select></td>
        </tr>
        <tr>
            <td class="row-num">113</td><td class="label-cell">10.3.4 ' (砖)</td>
            <td><input data-addr="G113"></td><td><input data-addr="I113"></td><td><input data-addr="J113"></td><td>---</td>
            <td><select data-addr="L113"><option value="转">转</option></select></td>
        </tr>
    </table>

    <div class="section-h">4.  住 转 (砖专转 127-138)</div>
    <table>
        <tr>
            <td class="row-num">132</td><td class="label-cell"> (10.3.5 ')</td>
            <td>砖 S: <input data-addr="I127"></td><td>转爪: <input data-addr="I132"></td><td>专砖: <input data-addr="K132"></td>
            <td><select data-addr="L133"><option value="转">转</option></select></td>
        </tr>
        <tr>
            <td class="row-num">137</td><td class="label-cell">拽 转转 (10.3.1)</td>
            <td colspan="3"><textarea data-addr="I137" rows="3" placeholder="驻专  爪 转  砖 注拽, 专, 住拽 '..."></textarea></td>
            <td><select data-addr="L138"><option value="转">转</option><option value=" 转"> 转</option></select></td>
        </tr>
    </table>

    <div class="action-bar">
        <button class="btn-submit" onclick="runExport()"> 砖转  驻拽 拽住 砖</button>
    </div>
</div>

<script>
    async function runExport() {
        const cells = {};
        // 住祝  砖  转 驻 转转 拽住 砖
        document.querySelectorAll('[data-addr]').forEach(el => {
            cells[el.getAttribute('data-addr')] = el.value;
        });

        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ cells })
        });

        if (res.ok) {
            const blob = await res.blob();
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = "Report_1142_Final.xlsx";
            a.click();
        } else {
            alert("砖 转拽砖专转 注 砖专转");
        }
    }
</script>
</body>
</html>
