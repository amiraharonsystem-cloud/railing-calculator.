<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>" 拽  - 138 砖专转</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f4f9; padding: 10px; }
        .wrapper { max-width: 850px; margin: auto; background: white; border-radius: 10px; box-shadow: 0 0 15px rgba(0,0,0,0.2); }
        .header-top { background: #004085; color: white; padding: 15px; text-align: center; border-radius: 10px 10px 0 0; }
        .step { padding: 20px; border-bottom: 1px solid #ddd; }
        .step-title { font-weight: bold; color: #004085; font-size: 1.2em; margin-bottom: 15px; display: block; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        label { display: block; margin-top: 10px; font-weight: bold; font-size: 14px; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #bbb; border-radius: 5px; box-sizing: border-box; font-size: 16px; }
        .btn-container { padding: 20px; text-align: center; }
        button { background: #28a745; color: white; border: none; padding: 20px 40px; font-size: 24px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="header-top"><h1> " 注拽 - 注 1-3</h1></div>

    <div class="step">
        <span class="step-title">1. 驻专  (砖专转 3-10)</span>
        <div class="grid">
            <div><label>转专 拽</label><input type="date" id="testDate"></div>
            <div><label>拽 驻专拽</label><input type="text" id="projectId"></div>
        </div>
        <label>砖 转专 (转转 )</label><input type="text" id="siteName">
    </div>

    <div class="step">
        <span class="step-title">2. 驻专 拽  (砖专转 7-14)</span>
        <div class="grid">
            <div><label>砖 </label><input type="text" id="clientName"></div>
            <div><label>爪 </label><input type="text" id="clientRep"></div>
        </div>
        <label>转专  (砖专 10)</label><input type="text" id="structureType">
        <label>转专 驻专 (砖专 11)</label><input type="text" id="itemDesc">
        <label>拽 拽 (砖专 12)</label><input type="text" id="testLocation">
        <div class="grid">
            <div><label>转 注拽 (砖专 13)</label><select id="planningStatus"><option> 砖</option><option>砖</option></select></div>
            <div><label>砖 住 (砖专 14)</label><select id="calcStatus"><option> 砖</option><option>砖</option></select></div>
        </div>
    </div>

    <div class="step">
        <span class="step-title">3. 转  注住 (砖专转 22-31)</span>
        <div class="grid">
            <div><label>L1 -  爪</label><input type="text" id="L1"></div>
            <div><label>L2 - 砖 住</label><input type="text" id="L2"></div>
            <div><label>L -  </label><input type="text" id="L_gap"></div>
            <div><label>注住 专 ws</label><input type="text" id="ws_val"></div>
        </div>
    </div>

    <div class="step">
        <span class="step-title">4. 转爪转 住 (砖专转 35-138)</span>
        <label>转爪 10.3.3</label>
        <select id="res1033"><option>注 专砖转 转拽</option><option> 注</option><option>N/A</option></select>
        <label>转爪 10.3.4</label>
        <select id="res1034"><option>注 专砖转 转拽</option><option> 注</option><option>N/A</option></select>
        <label>转爪 10.3.5</label>
        <select id="res1035"><option>注 专砖转 转拽</option><option> 注</option><option>N/A</option></select>
        
        <label>注专转 拽 (砖专 40)</label><textarea id="notes" rows="3"></textarea>
        <label>砖 拽 (砖专 42)</label><input type="text" id="testerName">
    </div>

    <div class="btn-container">
        <button onclick="download()"> 驻拽 拽住  (138 砖专转)</button>
    </div>
</div>

<script>
    async function download() {
        const data = {};
        document.querySelectorAll('input, select, textarea').forEach(el => data[el.id] = el.value);
        
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(data)
        });
        
        if(res.ok) {
            const blob = await res.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Full_Report_${data.projectId || 'New'}.xlsx`;
            a.click();
        } else { alert("转拽 砖专转 - 拽 砖拽抓 template.xlsx 拽 -GitHub"); }
    }
</script>
</body>
</html>
