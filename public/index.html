<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>注专转 住转 1142 -  </title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Assistant', sans-serif; background: #f4f7f9; margin: 0; padding: 20px; color: #2c3e50; }
        .wrapper { max-width: 1100px; margin: auto; }
        .main-title { text-align: center; color: #1a73e8; font-size: 2.8rem; margin-bottom: 40px; font-weight: 800; }
        
        .card { background: white; border-radius: 15px; padding: 35px; margin-bottom: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .card-header { font-size: 1.6rem; font-weight: 700; color: #1a237e; border-bottom: 3px solid #e8f0fe; padding-bottom: 15px; margin-bottom: 25px; display: flex; justify-content: space-between; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px; }
        .field { display: flex; flex-direction: column; }
        label { font-weight: 600; font-size: 1.15rem; margin-bottom: 8px; color: #444; }
        
        input, select, textarea { 
            padding: 14px; border: 2px solid #dce1e8; border-radius: 10px; font-size: 1.1rem; outline: none; transition: 0.3s;
        }
        input:focus { border-color: #1a73e8; background: #fcfdfe; }
        
        .sub-section { grid-column: 1 / -1; background: #f8f9fa; padding: 15px; border-right: 5px solid #1a73e8; margin: 15px 0; font-weight: bold; font-size: 1.2rem; }
        
        .footer-actions { position: sticky; bottom: 20px; text-align: center; padding: 20px; }
        .btn-generate { 
            background: #2e7d32; color: white; padding: 20px 100px; font-size: 1.6rem; font-weight: 700; 
            border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 10px 30px rgba(46,125,50,0.3);
        }
        .btn-generate:hover { background: #1b5e20; transform: scale(1.02); }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="main-title"> 注 转" 1142</div>

    <div class="card">
        <div class="card-header"><span>1. 驻专  </span> <small style="font-size: 0.8rem; color:#999;">砖专转 1-30</small></div>
        <div class="grid">
            <div class="field"><label>住驻专 " (H2)</label><input data-addr="H2"></div>
            <div class="field"><label>转专 (L3)</label><input data-addr="L3" type="date"></div>
            <div class="field"><label>拽 驻专拽 (L4)</label><input data-addr="L4"></div>
            <div class="field" style="grid-column: span 2;"><label>砖 转专 (C4)</label><input data-addr="C4"></div>
            <div class="field" style="grid-column: span 2;"><label>砖  (C7)</label><input data-addr="C7"></div>
            <div class="field" style="grid-column: span 2;"><label>注  (I7)</label><input data-addr="I7"></div>
        </div>
    </div>

    <div class="card">
        <div class="card-header"><span>2. 爪 砖转转祝 拽</span> <small style="font-size: 0.8rem; color:#999;">砖专转 31-38</small></div>
        <div class="grid">
            <div class="field"><label>注专转 驻注转 注住 (C32)</label><input data-addr="C32" value=" 专转"></div>
            <div class="field"><label>  (C34)</label><input data-addr="C34"></div>
            <div class="field"><label> 转 (C36)</label><input data-addr="C36"></div>
            <div class="field"><label>转拽祝  (L34)</label><input data-addr="L34" type="date"></div>
        </div>
    </div>

    <div class="card">
        <div class="card-header"><span>3. 转专 注拽 驻专</span> <small style="font-size: 0.8rem; color:#999;">砖专转 40-78</small></div>
        <div class="grid">
            <div class="sub-section">驻专驻 爪</div>
            <div class="field"><label>专 (C45)</label><input data-addr="C45"></div>
            <div class="field"><label>专 (F45)</label><input data-addr="F45"></div>
            <div class="field"><label>专砖 (H45)</label><input data-addr="H45"></div>
            <div class="field"><label>住拽 (L45)</label>
                <select data-addr="L45"><option value="转">转</option><option value=" 转"> 转</option></select>
            </div>

            <div class="sub-section">转</div>
            <div class="field"><label>住 (G70)</label><input data-addr="G70"></div>
            <div class="field"><label>注 (G67)</label><input data-addr="G67"></div>
            <div class="field"><label>住拽 (L70)</label><select data-addr="L70"><option>转</option></select></div>
        </div>
    </div>

    <div class="card">
        <div class="card-header"><span>4. 转爪转 拽转 注住 (10.3.4)</span> <small style="font-size: 0.8rem; color:#999;">砖专转 100-117</small></div>
        <div class="grid">
            <div class="sub-section">10.3.4 ' - 注住 驻拽 砖专转</div>
            <div class="field"><label>注住 N (G107)</label><input data-addr="G107"></div>
            <div class="field"><label>转 " (I107)</label><input data-addr="I107"></div>
            <div class="field"><label>砖专转 (J107)</label><input data-addr="J107"></div>
            <div class="field"><label>住拽 (L107)</label><select data-addr="L107"><option>转</option><option> 转</option></select></div>

            <div class="sub-section">10.3.4 ' - 注住 爪</div>
            <div class="field"><label>注住 N (G111)</label><input data-addr="G111"></div>
            <div class="field"><label>转 (I111)</label><input data-addr="I111"></div>
            <div class="field"><label>住拽 (L111)</label><select data-addr="L111"><option>转</option></select></div>

            <div class="sub-section">10.3.4 ' - 注住 砖</div>
            <div class="field"><label>注住 N (G113)</label><input data-addr="G113"></div>
            <div class="field"><label>砖专转 (J113)</label><input data-addr="J113"></div>
            <div class="field"><label>住拽 (L113)</label><select data-addr="L113"><option>转</option></select></div>
        </div>
    </div>

    <div class="card">
        <div class="card-header"><span>5.  住 住驻</span> <small style="font-size: 0.8rem; color:#999;">砖专转 120-138</small></div>
        <div class="grid">
            <div class="field"><label>砖  S (I127)</label><input data-addr="I127"></div>
            <div class="field"><label>转爪转 拽 (I132)</label><input data-addr="I132"></div>
            <div class="field"><label>住拽  (L133)</label><select data-addr="L133"><option>转</option></select></div>
            
            <div class="field" style="grid-column: span 3;">
                <label>爪 转 10.3.1 (I137)</label>
                <textarea data-addr="I137" rows="3"></textarea>
            </div>
            <div class="field" style="grid-column: span 1;">
                <label>住拽 住驻转 (L138)</label>
                <select data-addr="L138" style="background: #e8f5e9; font-weight: bold;">
                    <option value="转">注 专砖转</option>
                    <option value=" 转"> 注 专砖转</option>
                </select>
            </div>
        </div>
    </div>

    <div class="footer-actions">
        <button class="btn-generate" onclick="submitData()"> 驻拽 拽住 住  (1:1)</button>
    </div>
</div>

<script>
    async function submitData() {
        const cells = {};
        document.querySelectorAll('[data-addr]').forEach(el => cells[el.getAttribute('data-addr')] = el.value);
        
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ cells })
        });

        if(res.ok) {
            const blob = await res.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "TI_1142_Final_Report.xlsx";
            a.click();
        }
    }
</script>
</body>
</html>
