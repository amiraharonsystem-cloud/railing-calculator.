<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>××¢×¨×›×ª × ×™×”×•×œ ×“×•×—×•×ª ×ª"×™ 1142 - ×’×¨×¡×” ××œ××”</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Assistant', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; color: #1c1e21; }
        .container { max-width: 1200px; margin: auto; }
        
        /* Header */
        .page-header { background: #fff; padding: 30px; border-radius: 15px; margin-bottom: 30px; border-bottom: 5px solid #1a73e8; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .page-header h1 { margin: 0; color: #1a73e8; font-size: 2.2rem; }

        /* Card System */
        .card { background: #fff; border-radius: 12px; padding: 25px; margin-bottom: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .card-title { font-size: 1.4rem; font-weight: 700; color: #1565c0; margin-bottom: 20px; border-bottom: 2px solid #e3f2fd; padding-bottom: 10px; }

        /* Form Layout */
        .form-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
        .field { display: flex; flex-direction: column; }
        .field.span-2 { grid-column: span 2; }
        .field.span-4 { grid-column: span 4; }

        label { font-weight: 600; margin-bottom: 8px; color: #444; font-size: 1.1rem; }
        input, select, textarea { padding: 12px; border: 2px solid #dfe1e5; border-radius: 8px; font-size: 1.1rem; outline: none; transition: 0.2s; }
        input:focus { border-color: #1a73e8; box-shadow: 0 0 0 3px rgba(26,115,232,0.1); }

        .section-label { grid-column: span 4; background: #f8f9fa; padding: 10px 15px; border-right: 5px solid #1a73e8; font-weight: bold; margin: 10px 0; }

        /* Action Bar */
        .action-bar { position: sticky; bottom: 20px; text-align: center; margin-top: 40px; }
        .btn-main { background: #2e7d32; color: #fff; border: none; padding: 18px 100px; font-size: 1.5rem; font-weight: 700; border-radius: 50px; cursor: pointer; box-shadow: 0 10px 20px rgba(46,125,50,0.3); }
        .btn-main:hover { background: #1b5e20; transform: translateY(-2px); }
    </style>
</head>
<body>

<div class="container">
    <div class="page-header">
        <h1>×ª×¢×•×“×ª ×‘×“×™×§×ª ××¢×§×” ×‘××¢×˜×¤×ª ×”×‘× ×™×™×Ÿ</h1>
        <p>××™×œ×•×™ × ×ª×•× ×™× ×¢×‘×•×¨ ×ª"×™ 1142 - ×’×¨×¡×” ×”× ×“×¡×™×ª ××œ××”</p>
    </div>

    <div class="card">
        <div class="card-title">1. ×¤×¨×˜×™ ×–×™×”×•×™ ×•××™× ×”×œ×” (×©×•×¨×•×ª 1-20)</div>
        <div class="form-grid">
            <div class="field"><label>××¡' ×“×•"×— (L2)</label><input data-addr="L2"></div>
            <div class="field"><label>×ª××¨×™×š ×‘×“×™×§×” (L3)</label><input data-addr="L3" type="date"></div>
            <div class="field"><label>×§×•×“ ×¤×¨×•×™×§×˜ (L4)</label><input data-addr="L4"></div>
            <div class="field"><label>×‘×“×™×§×” ×—×•×–×¨×ª? (L10)</label>
                <select data-addr="L10"><option value="×¨××©×•× ×”">×¨××©×•× ×”</option><option value="×—×•×–×¨×ª">×—×•×–×¨×ª</option></select>
            </div>

            <div class="section-label">×¤×¨×˜×™ ×”××–××™×Ÿ ×•×”××‘× ×”</div>
            <div class="field span-2"><label>×©× ×”××–××™×Ÿ (L7)</label><input data-addr="L7"></div>
            <div class="field span-2"><label>×›×ª×•×‘×ª ×”××ª×¨/×”××‘× ×” (L8)</label><input data-addr="L8"></div>
            <div class="field span-2"><label>×ª×™××•×¨ ×”××‘× ×” (L12)</label><input data-addr="L12" placeholder="×œ×“×•×’××”: ×‘× ×™×™×Ÿ ××’×•×¨×™× 12 ×§×•××•×ª"></div>
            <div class="field span-2"><label>××§×•× ×”×‘×“×™×§×” (L14)</label><input data-addr="L14" placeholder="××¨×¤×¡×•×ª ×—×–×™×ª ×¦×¤×•× ×™×ª"></div>
        </div>
    </div>

    <div class="card">
        <div class="card-header card-title">2. ×ª×™××•×¨ ×”××¢×§×” ×•××¨×›×™×‘×™×• (×©×•×¨×•×ª 45-75)</div>
        <div class="form-grid">
            <div class="field span-2"><label>×“×’× ×”××¢×§×” (L15)</label><input data-addr="L15"></div>
            <div class="field"><label>×’×•×‘×” ××¢×§×” (L16)</label><input data-addr="L16" type="number" step="0.1"></div>
            
            <div class="section-label">×¤×¨×˜×™ ×—×•××¨×™×</div>
            <div class="field"><label>×—×•××¨ × ×™×¦×‘ (C45)</label><input data-addr="C45"></div>
            <div class="field"><label>×’××¨ × ×™×¦×‘ (F45)</label><input data-addr="F45"></div>
            <div class="field"><label>×¡×•×’ ×–×›×•×›×™×ª (G70)</label><input data-addr="G70"></div>
            <div class="field"><label>×¢×•×‘×™ ×–×›×•×›×™×ª (G67)</label><input data-addr="G67"></div>
        </div>
    </div>

    <div class="card">
        <div class="card-title">3. ×ª×•×¦××•×ª ×‘×“×™×§×” - ×¢×•××¡×™× (×¡×¢×™×£ 10.3.4)</div>
        <div class="form-grid">
            <div class="section-label">×¡×¢×™×£ 10.3.4 ×' - ×¢×•××¡ ××•×¤×§×™ (×©×™×¨×•×ª)</div>
            <div class="field"><label>×¢×•××¡ ××•×¤×¢×œ N (G107)</label><input data-addr="G107"></div>
            <div class="field"><label>×ª×–×•×–×” I (I107)</label><input data-addr="I107"></div>
            <div class="field"><label>×©×™×•×¨×™×ª J (J107)</label><input data-addr="J107"></div>
            <div class="field"><label>××¡×§× ×” (L107)</label>
                <select data-addr="L107"><option value="××ª××™×">××ª××™× âœ…</option><option value="×œ× ××ª××™×">×œ× ××ª××™× âŒ</option></select>
            </div>

            <div class="section-label">×¡×¢×™×£ 10.3.4 ×’' - ×¢×•××¡ × ×™×¦×‘</div>
            <div class="field"><label>×¢×•××¡ ××•×¤×¢×œ N (G111)</label><input data-addr="G111"></div>
            <div class="field"><label>××¡×§× ×” (L111)</label><select data-addr="L111"><option value="××ª××™×">××ª××™×</option></select></div>
        </div>
    </div>

    <div class="card">
        <div class="card-title">4. ×¡×™×›×•× ×•×××¦××™× ×—×–×•×ª×™×™×</div>
        <div class="form-grid">
            <div class="field span-4">
                <label>×××¦××™× ×—×–×•×ª×™×™× 10.3.1 (I137)</label>
                <textarea data-addr="I137" rows="3" placeholder="×¤×¨×˜ ×××¦××™× ×œ×’×‘×™ ×—×™×‘×•×¨×™×, ×¢×™×’×•× ×™×, ×¡×“×§×™×..."></textarea>
            </div>
            <div class="field span-2">
                <label>××¡×§× ×” ×¡×•×¤×™×ª ×©×œ ×”××¢×‘×“×” (L138)</label>
                <select data-addr="L138" style="background: #e8f5e9; font-weight: bold; border-color: #2e7d32;">
                    <option value="××ª××™×">×”××¢×§×” ×¢×•××“ ×‘×“×¨×™×©×•×ª ×ª"×™ 1142</option>
                    <option value="×œ× ××ª××™×">×”××¢×§×” ××™× ×• ×¢×•××“ ×‘×“×¨×™×©×•×ª</option>
                </select>
            </div>
            <div class="field span-2">
                <label>×©× ×”×‘×•×“×§ / ×—×•×ª××ª (L145)</label>
                <input data-addr="L145">
            </div>
        </div>
    </div>

    <div class="action-bar">
        <button class="btn-main" onclick="generate()">ğŸ’¾ ×”×¤×§ ××§×¡×œ ×”× ×“×¡×™ ××œ× (1:1)</button>
    </div>
</div>

<script>
    async function generate() {
        const cells = {};
        document.querySelectorAll('[data-addr]').forEach(el => cells[el.getAttribute('data-addr')] = el.value);
        
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ cells })
        });

        if(res.ok) {
            const blob = await res.blob();
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `Report_Full_1142_${new Date().toLocaleDateString()}.xlsx`;
            a.click();
        }
    }
</script>
</body>
</html>
