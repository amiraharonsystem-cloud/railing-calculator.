<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 20px; direction: rtl; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 30px; border: 1px solid #ccc; }
        .section { border: 2px solid #2c3e50; margin-bottom: 20px; padding: 15px; }
        .section-h { background: #2c3e50; color: white; padding: 5px 10px; margin: -15px -15px 15px -15px; font-weight: bold; }
        .row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 10px; }
        label { font-size: 12px; font-weight: bold; display: block; }
        input { width: 100%; padding: 5px; border: 1px solid #999; box-sizing: border-box; }
        .btn { background: #27ae60; color: white; padding: 20px; width: 100%; font-size: 20px; cursor: pointer; border: none; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="text-align:center">מערכת הזנת נתונים - דו"ח 1142 (לפי מפרט אקסל מלא)</h2>

    <div class="section">
        <div class="section-h">1. פרטי זיהוי (עמוד 1)</div>
        <div class="row">
            <div><label>מס' דו"ח (H2)</label><input id="H2"></div>
            <div><label>תאריך בדיקה (L3)</label><input type="date" id="L3"></div>
            <div><label>שם האתר (C4)</label><input id="C4"></div>
            <div><label>קוד פרויקט (L4)</label><input id="L4"></div>
        </div>
    </div>

    <div class="section">
        <div class="section-h">2. גאומטריה וזכוכית (לפי סעיף 6 ו-7)</div>
        <div class="row">
            <div><label>גובה מעקה (E56)</label><input id="E56"></div>
            <div><label>מרווח בין רכיבים (E60)</label><input id="E60"></div>
            <div><label>עובי זכוכית (G67)</label><input id="G67"></div>
            <div><label>סוג זכוכית (G70)</label><input id="G70"></div>
        </div>
    </div>

    <div class="section">
        <div class="section-h">3. חישובי עומס ורוח (עמוד 2)</div>
        <div class="row">
            <div><label>גובה מעל קרקע (F83)</label><input id="F83"></div>
            <div><label>לחץ רוח qb (F84)</label><input id="F84"></div>
            <div><label>לחץ תכנון We (H82)</label><input id="H82"></div>
            <div><label>כוח רוח Fw (H84)</label><input id="H84"></div>
        </div>
    </div>

    <div class="section">
        <div class="section-h">4. תוצאות בדיקה (עמוד 3)</div>
        <div class="row">
            <div style="grid-column: span 4; font-weight: bold; border-bottom: 1px solid #ddd;">סעיף 10.3.4 (עומס אופקי)</div>
            <div><label>תזוזה אופקית (I107)</label><input id="I107"></div>
            <div><label>תזוזה שיורית (J107)</label><input id="J107"></div>
            <div><label>מסקנה (L107)</label><input id="L107" placeholder="מתאים"></div>
        </div>
        <div class="row" style="margin-top: 15px;">
            <div style="grid-column: span 4; font-weight: bold; border-bottom: 1px solid #ddd;">סעיף 10.3.5 (עומס מליא)</div>
            <div><label>שטח הלוח S (H127)</label><input id="H127"></div>
            <div><label>תוצאת בדיקה (I132)</label><input id="I132"></div>
            <div><label>מסקנה סופית (L133)</label><input id="L133"></div>
        </div>
    </div>

    <button class="btn" onclick="generate()">הפק אקסל זהה למקור (Render)</button>
</div>

<script>
    async function generate() {
        const d = {};
        document.querySelectorAll('input').forEach(i => d[i.id] = i.value);
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(d)
        });
        const blob = await res.blob();
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "Final_Report.xlsx";
        a.click();
    }
</script>

</body>
</html>
