<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>דו"ח 1142 - מילוי מלא</title>
    <style>
        body { font-family: Arial; background: #eee; direction: rtl; padding: 10px; }
        .page { background: white; max-width: 900px; margin: auto; padding: 20px; border: 1px solid #000; }
        .row { display: flex; align-items: center; border-bottom: 1px solid #ddd; padding: 5px 0; }
        .label { width: 300px; font-weight: bold; font-size: 14px; color: #2c3e50; }
        input, select { flex: 1; padding: 8px; border: 1px solid #ccc; }
        .header { background: #2c3e50; color: white; padding: 10px; font-weight: bold; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #000; padding: 5px; text-align: center; }
        .btn { background: #27ae60; color: white; width: 100%; padding: 20px; font-size: 20px; cursor: pointer; border: none; margin-top: 20px; }
    </style>
</head>
<body>

<div class="page">
    <h2 style="text-align:center">תעודת בדיקת מעקה - מילוי כל שורות הדו"ח</h2>

    <div class="header">פרטי כותרת</div>
    <div class="row"><div class="label">דו"ח מס'</div><input id="reportNum"></div>
    <div class="row"><div class="label">מבטל ומחליף דו"ח מס'</div><input id="replacedReportNum"></div>
    <div class="row"><div class="label">תאריך בדיקה</div><input type="date" id="testDate"></div>
    <div class="row"><div class="label">שם האתר</div><input id="siteName"></div>
    <div class="row"><div class="label">קוד פרויקט</div><input id="projectId"></div>

    <div class="header">1. פרטי הלקוח והזמנה</div>
    <div class="row"><div class="label">שם המזמין</div><input id="clientName"></div>
    <div class="row"><div class="label">מען המזמין</div><input id="clientAddress"></div>
    <div class="row"><div class="label">נציג המזמין בבדיקה</div><input id="presenterName"></div>
    <div class="row"><div class="label">כתובת האתר</div><input id="siteAddress"></div>
    <div class="row"><div class="label">הבדיקה הינה</div><select id="testType"><option>ראשונה</option><option>חוזרת</option></select></div>

    <div class="header">2. פרטים על המערכת וסטטוס לפני בדיקה</div>
    <div class="row"><div class="label">תיאור המבנה</div><input id="structureType"></div>
    <div class="row"><div class="label">תיאור הפריט</div><input id="itemDesc"></div>
    <div class="row"><div class="label">מיקום הבדיקה</div><input id="testLocation"></div>
    <div class="row"><div class="label">תכנון המעקה (V/X)</div><input id="planOk"></div>
    <div class="row"><div class="label">חישוב הנדסי שלד (V/X)</div><input id="engOk"></div>
    <div class="row"><div class="label">חישוב הנדסי לוח מליא (V/X)</div><input id="glassOk"></div>

    <div class="header">3. נתונים וערכים לחישוב</div>
    <div class="row"><div class="label">Fser (ק"נ/מ')</div><input id="Fser"></div>
    <div class="row"><div class="label">P - עומס מחושב (ק"נ)</div><input id="P_calc"></div>
    <div class="row"><div class="label">L1 - מרחק בין ניצבים (מ')</div><input id="L1"></div>
    <div class="row"><div class="label">L2 - מפתח שדה סמוך (מ')</div><input id="L2"></div>
    <div class="row"><div class="label">L - מפתח לוח מליא (מ')</div><input id="L_fill"></div>

    <div class="header">חישוב עומס רוח (10.3.5 ג')</div>
    <div class="row"><div class="label">we (נ'/מ"ר)</div><input id="we"></div>
    <div class="row"><div class="label">S - שטח הלוח (מ"ר)</div><input id="S_area"></div>
    <div class="row"><div class="label">ws (עומס כולל נ')</div><input id="ws_total"></div>

    <div class="header">תוצאות הבדיקה - טבלה מלאה</div>
    <table>
        <tr><th>סעיף</th><th>תזוזה I</th><th>שיורית J</th><th>מסקנה</th></tr>
        <tr><td>10.3.4 א'</td><td><input id="hor_a"></td><td><input id="res_a"></td><td><input id="stat_a"></td></tr>
        <tr><td>10.3.4 ב'</td><td><input id="hor_b"></td><td><input id="res_b"></td><td><input id="stat_b"></td></tr>
        <tr><td>10.3.5 ג'</td><td><input id="hor_c"></td><td><input id="res_c"></td><td><input id="stat_c"></td></tr>
        <tr><td>10.3.5 ד'</td><td><input id="hor_d"></td><td><input id="res_d"></td><td><input id="stat_d"></td></tr>
        <tr><td>10.3.5 ה'</td><td><input id="hor_e"></td><td><input id="res_e"></td><td><input id="stat_e"></td></tr>
    </table>

    <div class="header">סיכום וחתימות</div>
    <div class="row"><div class="label">מסקנות</div><input id="conclusion"></div>
    <div class="row"><div class="label">שם הבודק</div><input id="tester"></div>
    <div class="row"><div class="label">מאשר הדו"ח</div><input id="approver"></div>

    <button class="btn" onclick="generate()">הפק אקסל - כל השורות</button>
</div>

<script>
    async function generate() {
        const d = {};
        document.querySelectorAll('input, select').forEach(el => d[el.id] = el.value);
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(d)
        });
        const blob = await res.blob();
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "Railing_Report_Complete.xlsx";
        a.click();
    }
</script>
</body>
</html>
