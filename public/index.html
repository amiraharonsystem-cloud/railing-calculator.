<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>注专转 转 转" 1142 - 驻专住 </title>
    <style>
        :root { --main: #1a237e; --bg: #f4f7f9; }
        body { font-family: 'Segoe UI', system-ui; background: var(--bg); margin: 0; padding: 20px; }
        .container { background: white; max-width: 1200px; margin: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; }
        .header { background: var(--main); color: white; padding: 20px; text-align: center; }
        .section { padding: 20px; border-bottom: 2px solid #eee; }
        .section-h { font-weight: bold; color: var(--main); margin-bottom: 15px; border-right: 5px solid orange; padding-right: 10px; }
        
        table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: center; font-size: 13px; }
        th { background: #f8f9fa; }
        .label-cell { background: #fafafa; font-weight: bold; text-align: right; width: 180px; }
        
        input, select { width: 100%; border: 1px solid #ddd; padding: 8px; box-sizing: border-box; border-radius: 4px; }
        input:focus { border-color: orange; outline: none; background: #fffde7; }
        
        .footer-bar { position: sticky; bottom: 0; background: white; padding: 20px; text-align: center; border-top: 3px solid var(--main); }
        .btn-submit { background: #2e7d32; color: white; padding: 15px 80px; font-size: 22px; border: none; cursor: pointer; border-radius: 50px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="header"><h1>注专  拽 转" 1142 (砖专转 1-138)</h1></div>

    <div class="section">
        <div class="section-h">1. 驻专   (注 1)</div>
        <table>
            <tr>
                <td class="label-cell">住' " (H2)</td><td><input data-addr="H2"></td>
                <td class="label-cell">转专 (L3)</td><td><input data-addr="L3" type="date"></td>
            </tr>
            <tr>
                <td class="label-cell">砖 转专 (C4)</td><td><input data-addr="C4"></td>
                <td class="label-cell">拽 驻专拽 (L4)</td><td><input data-addr="L4"></td>
            </tr>
            <tr>
                <td class="label-cell">砖  (C7)</td><td><input data-addr="C7"></td>
                <td class="label-cell">注  (I7)</td><td><input data-addr="I7"></td>
            </tr>
        </table>
    </div>

    <div class="section">
        <div class="section-h">2. 驻专  砖 专 (砖专转 45-85)</div>
        <table>
            <tr>
                <th>驻专专</th><th>专/住 (C)</th><th>专 (F/I)</th><th>专砖 (H)</th><th>住拽 (L)</th>
            </tr>
            <tr>
                <td class="label-cell">驻专驻 爪 (45)</td>
                <td><input data-addr="C45"></td><td><input data-addr="F45"></td><td><input data-addr="H45"></td>
                <td><select data-addr="L45"><option>转</option><option> 转</option></select></td>
            </tr>
            <tr>
                <td class="label-cell">住 转 (70)</td>
                <td><input data-addr="G70"></td><td>注: <input data-addr="G67"></td><td>---</td>
                <td><select data-addr="L70"><option>转</option></select></td>
            </tr>
        </table>
        <h4 style="margin:10px 0 5px 0">砖 注住 专:</h4>
        <table>
            <tr>
                <th>qb (F84)</th><th>Ce (K84)</th><th>CsCd (L84)</th><th>Cf (M84)</th><th>抓 We (I82)</th><th> Fw (I84)</th>
            </tr>
            <tr>
                <td><input data-addr="F84"></td><td><input data-addr="K84"></td><td><input data-addr="L84"></td>
                <td><input data-addr="M84"></td><td><input data-addr="I82"></td><td><input data-addr="I84"></td>
            </tr>
        </table>
    </div>

    <div class="section">
        <div class="section-h">3. 转爪转 拽 10.3.4 - 注住 驻拽 (砖专转 107-117)</div>
        <table>
            <tr>
                <th>住注祝 拽</th><th>注住 N (G)</th><th>转 I (")</th><th>砖专转 J (")</th><th>专砖 (K)</th><th>住拽 (L)</th>
            </tr>
            <tr>
                <td class="label-cell">10.3.4 ' (砖专转)</td>
                <td><input data-addr="G107"></td><td><input data-addr="I107"></td><td><input data-addr="J107"></td><td><input data-addr="K107"></td>
                <td><select data-addr="L107"><option>转</option><option> 转</option></select></td>
            </tr>
            <tr>
                <td class="label-cell">10.3.4 ' (爪)</td>
                <td><input data-addr="G111"></td><td><input data-addr="I111"></td><td><input data-addr="J111"></td><td><input data-addr="K111"></td>
                <td><select data-addr="L111"><option>转</option></select></td>
            </tr>
            <tr>
                <td class="label-cell">10.3.4 ' (砖)</td>
                <td><input data-addr="G113"></td><td><input data-addr="I113"></td><td><input data-addr="J113"></td><td>---</td>
                <td><select data-addr="L113"><option>转</option></select></td>
            </tr>
        </table>
    </div>

    <div class="section">
        <div class="section-h">4.  拽 转转 (砖专转 127-138)</div>
        <table>
            <tr>
                <td class="label-cell"> 10.3.5 (132)</td>
                <td>砖 S: <input data-addr="I127"></td>
                <td>转爪: <input data-addr="I132"></td>
                <td>住拽: <select data-addr="L133"><option>转</option></select></td>
            </tr>
            <tr>
                <td class="label-cell">转转 10.3.1 (137)</td>
                <td colspan="2"><input data-addr="I137" placeholder="爪 (住拽, 注 ')"></td>
                <td>住拽: <select data-addr="L138"><option>转</option><option> 转</option></select></td>
            </tr>
        </table>
    </div>

    <div class="footer-bar">
        <button class="btn-submit" onclick="generate()"> 驻拽  拽住  (1:1 拽专)</button>
    </div>
</div>

<script>
    async function generate() {
        const cells = {};
        // 住专拽 转  砖转 拽 驻住 住祝 转 转转 砖
        document.querySelectorAll('[data-addr]').forEach(el => {
            cells[el.getAttribute('data-addr')] = el.value;
        });

        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ cells })
        });

        if(res.ok) {
            const blob = await res.blob();
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = "Final_Report_1142.xlsx";
            a.click();
        } else {
            alert("砖 转拽砖专转 注 砖专转");
        }
    }
</script>
</body>
</html>
