<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; direction: rtl; padding: 20px; }
        .card { background: white; max-width: 1000px; margin: auto; padding: 30px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .tab-content { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-top: 20px; }
        .section-h { background: #2c3e50; color: white; padding: 10px; grid-column: span 3; font-weight: bold; margin-top: 10px; }
        label { font-size: 13px; font-weight: bold; color: #444; }
        input, select { padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%; box-sizing: border-box; }
        .btn-main { background: #27ae60; color: white; width: 100%; padding: 20px; border: none; font-size: 20px; font-weight: bold; cursor: pointer; margin-top: 30px; border-radius: 5px; }
        table { width: 100%; border-collapse: collapse; grid-column: span 3; margin-top: 15px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
    </style>
</head>
<body>

<div class="card">
    <h1 style="text-align: center; color: #2c3e50;">注专转 " 拽 转" 1142 - 专住 </h1>
    
    <div class="tab-content">
        <div class="section-h">1. 驻专  "</div>
        <div><label>住驻专 "</label><input id="reportNum"></div>
        <div><label> 祝 " 住'</label><input id="replacedReport"></div>
        <div><label>转专 拽</label><input type="date" id="testDate"></div>
        <div><label>砖 转专</label><input id="siteName"></div>
        <div><label>拽 驻专拽</label><input id="projectId"></div>
        <div><label>爪 </label><input id="presenterName"></div>

        <div class="section-h">2. 驻专 注拽 (驻专驻 注)</div>
        <div><label>住 驻专驻 爪</label><input id="profileType"></div>
        <div><label>专 驻专驻</label><input id="profileFinish"></div>
        <div><label>住 注</label><input id="anchorType"></div>
        <div><label>转专 注</label><input id="anchorDesc"></div>
        <div><label>专</label><input id="screwType"></div>
        <div><label>住注 </label><input id="topRail"></div>

        <div class="section-h">3. 驻专  (转)</div>
        <div><label>专  (')</label><input id="glassW"></div>
        <div><label>  (')</label><input id="glassH"></div>
        <div><label>注 (")</label><input id="glassThick"></div>
        <div><label>住 转</label><input id="glassType"></div>
        <div><label>转 注拽</label><select id="planStatus"><option>砖</option><option> 砖</option></select></div>
        <div><label>砖 砖</label><select id="engStatus"><option>砖</option><option> 砖</option></select></div>

        <div class="section-h">4. 转 住 专</div>
        <div><label>Fser (拽"/')</label><input id="Fser"></div>
        <div><label>L1 (')</label><input id="L1"></div>
        <div><label>L2 (')</label><input id="L2"></div>
        <div><label>we (抓 专)</label><input id="we_design"></div>
        <div><label>ws (注住 )</label><input id="ws_total"></div>

        <div class="section-h">5. 转 转爪转 (驻拽转, 专转, )</div>
        <table>
            <tr><th>住注祝</th><th>转 I</th><th>砖专转 J</th><th>住拽</th></tr>
            <tr><td>10.3.4 '</td><td><input id="hor_a"></td><td><input id="res_a"></td><td><select id="stat_a"><option>转</option><option> 转</option></select></td></tr>
            <tr><td>10.3.5 '</td><td><input id="hor_c"></td><td><input id="res_c"></td><td><select id="stat_c"><option>转</option><option> 转</option></select></td></tr>
            <tr><td>10.3.5 '</td><td><input id="hor_d"></td><td><input id="res_d"></td><td><select id="stat_d"><option>转</option><option> 转</option></select></td></tr>
        </table>
    </div>

    <button class="btn-main" onclick="generate()"> 驻拽 " 拽住 住驻 - 100% 砖转</button>
</div>

<script>
    async function generate() {
        const d = {};
        document.querySelectorAll('input, select').forEach(el => d[el.id] = el.value);
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(d)
        });
        const blob = await res.blob();
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "Railing_Report_Complete.xlsx";
        a.click();
    }
</script>
</body>
</html>
