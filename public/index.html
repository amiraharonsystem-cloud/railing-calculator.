<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>" 注 转" 1142 - 专住 </title>
    <style>
        :root { --main: #1a2a3a; --accent: #27ae60; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; direction: rtl; margin: 0; padding: 20px; }
        .container { max-width: 1100px; margin: auto; background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .nav-tabs { display: flex; background: var(--main); border-radius: 12px 12px 0 0; overflow: hidden; }
        .nav-tabs button { flex: 1; padding: 18px; color: white; border: none; background: none; cursor: pointer; font-weight: bold; font-size: 15px; }
        .nav-tabs button.active { background: var(--accent); }
        .tab-content { padding: 30px; display: none; }
        .tab-content.active { display: block; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; }
        .section-h { border-bottom: 2px solid #eee; margin: 25px 0 15px; padding-bottom: 5px; color: var(--main); font-weight: bold; }
        label { display: block; font-size: 13px; color: #666; margin-bottom: 6px; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        .btn-gen { background: var(--accent); color: white; width: 100%; padding: 25px; border: none; border-radius: 0 0 12px 12px; font-size: 20px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav-tabs">
        <button class="active" onclick="openTab(0)">1.  转专</button>
        <button onclick="openTab(1)">2. 驻专 专</button>
        <button onclick="openTab(2)">3.  专</button>
        <button onclick="openTab(3)">4. 砖 转爪转</button>
    </div>

    <div class="tab-content active" id="tab0">
        <div class="section-h">驻专  转专</div>
        <div class="grid">
            <div><label>砖 </label><input type="text" id="clientName"></div>
            <div><label>注 </label><input type="text" id="clientAddress"></div>
            <div><label>爪 </label><input type="text" id="presenterName"></div>
            <div><label>拽 驻专拽</label><input type="text" id="projectId"></div>
            <div><label>转专 拽</label><input type="date" id="testDate"></div>
            <div><label>转 拽</label><select id="testType"><option>专砖</option><option>专转</option></select></div>
        </div>
        <div class="section-h">住住 住</div>
        <div class="grid">
            <div><label>转 注拽</label><select id="planStatus"><option>砖 (V)</option><option> 砖 (X)</option></select></div>
            <div><label>砖 砖</label><select id="engStatus"><option>砖 (V)</option><option> 砖 (X)</option></select></div>
            <div><label>砖  </label><select id="glassStatus"><option>砖 (V)</option><option> 砖 (X)</option></select></div>
        </div>
    </div>

    <div class="tab-content" id="tab1">
        <div class="section-h">驻专驻 注</div>
        <div class="grid">
            <div><label>住 驻专驻 爪</label><input type="text" id="profileType"></div>
            <div><label>专 (爪注/)</label><input type="text" id="profileFinish"></div>
            <div><label>住 注 (专/注)</label><input type="text" id="anchorType"></div>
            <div><label>转专 专 注</label><input type="text" id="anchorDesc"></div>
            <div><label>住  注</label><input type="text" id="topRailType"></div>
            <div><label>专 专</label><input type="text" id="screwType"></div>
        </div>
    </div>

    <div class="tab-content" id="tab2">
        <div class="section-h">驻专   (砖专转 66-76)</div>
        <div class="grid">
            <div><label>专  (')</label><input type="text" id="glassW"></div>
            <div><label>  (')</label><input type="text" id="glassH"></div>
            <div><label>注 (")</label><input type="text" id="glassThick"></div>
            <div><label>住 砖砖</label><input type="text" id="glassType"></div>
            <div><label>驻驻 住专转 (")</label><input type="text" id="overlap"></div>
            <div><label>住 爪专</label><select id="glassMark"><option>拽</option><option> 拽</option></select></div>
        </div>
        <div class="section-h">砖 专 (10.3.5 ')</div>
        <div class="grid">
            <div><label>We - 抓 专 ('/"专)</label><input type="text" id="We_wind"></div>
            <div><label>S - 砖  ("专)</label><input type="text" id="S_area"></div>
            <div><label>Ws - 注住  (')</label><input type="text" id="Ws_total"></div>
        </div>
    </div>

    <div class="tab-content" id="tab3">
        <div class="section-h">注专 砖 (P=Fser)</div>
        <div class="grid">
            <div><label>Fser (拽"/')</label><input type="text" id="Fser"></div>
            <div><label>L1 (')</label><input type="text" id="L1"></div>
            <div><label>L2 (')</label><input type="text" id="L2"></div>
            <div><label>P 砖</label><input type="text" id="P_calc"></div>
        </div>
        <div class="section-h">转 住 转爪转</div>
        <table border="1" style="width:100%; border-collapse: collapse; text-align: center;">
            <tr style="background:#eee"><th>住注祝</th><th>转 I</th><th>砖专转 J</th><th>住拽</th></tr>
            <tr><td>10.3.4 '</td><td><input id="hor_a"></td><td><input id="res_a"></td><td><select id="stat_a"><option>注</option><option> 注</option></select></td></tr>
            <tr><td>10.3.4 '</td><td><input id="hor_b"></td><td><input id="res_b"></td><td><select id="stat_b"><option>注</option><option> 注</option></select></td></tr>
            <tr><td>10.3.5 '</td><td><input id="hor_c"></td><td><input id="res_c"></td><td><select id="stat_c"><option>注</option><option> 注</option></select></td></tr>
        </table>
    </div>

    <button class="btn-gen" onclick="generate()"> 驻拽 "  (3 注)</button>
</div>

<script>
    function openTab(i) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.nav-tabs button').forEach(b => b.classList.remove('active'));
        document.getElementById('tab'+i).classList.add('active');
        event.target.classList.add('active');
    }
    async function generate() {
        const d = {};
        document.querySelectorAll('input, select').forEach(el => d[el.id] = el.value);
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(d)
        });
        const blob = await res.blob();
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "Full_Report_1142.xlsx";
        a.click();
    }
</script>
</body>
</html>
