<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>注专转 " 注 转" 1142</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; direction: rtl; padding: 20px; }
        .container { max-width: 900px; margin: auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .section-title { background: #2c3e50; color: white; padding: 10px; margin-top: 25px; font-weight: bold; }
        .field-group { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 15px; border: 1px solid #eee; }
        label { font-size: 13px; font-weight: bold; color: #444; }
        input, select { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
        .btn { background: #27ae60; color: white; width: 100%; padding: 20px; border: none; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <h1 style="text-align: center;">注专转 驻拽转 " 拽 - 转" 1142</h1>

    <div class="section-title">1. 驻专 拽  </div>
    <div class="field-group">
        <div><label>砖 </label><input type="text" id="clientName"></div>
        <div><label>注 </label><input type="text" id="clientAddress"></div>
        <div><label>爪  拽</label><input type="text" id="presenterName"></div>
        <div><label>转专 拽</label><input type="date" id="testDate"></div>
        <div><label>砖 转专</label><input type="text" id="siteName"></div>
        <div><label>转转 转专</label><input type="text" id="siteAddress"></div>
        <div><label>拽 驻专拽</label><input type="text" id="projectId"></div>
        <div><label>拽 </label><select id="testType"><option>专砖</option><option>专转</option></select></div>
    </div>

    <div class="section-title">2. 驻专 注 注专转 住住 驻 拽</div>
    <div class="field-group">
        <div><label>转专 </label><input type="text" id="structureType"></div>
        <div><label>转专 驻专 砖拽</label><input type="text" id="itemDesc"></div>
        <div><label>拽 拽</label><input type="text" id="testLocation"></div>
        <div><label>转 注拽</label><select id="planStatus"><option>砖</option><option> 砖</option></select></div>
        <div><label>砖 住 砖</label><select id="engStatus"><option>砖</option><option> 砖</option></select></div>
        <div><label>砖  </label><select id="glassStatus"><option>砖</option><option> 砖</option></select></div>
    </div>

    <div class="section-title">3. 转 注专 砖 (Fser, L1, L2)</div>
    <div class="field-group">
        <div><label>Fser (拽"/')</label><input type="number" step="0.01" id="Fser"></div>
        <div><label>L1 - 专拽  爪 (')</label><input type="number" step="0.01" id="L1"></div>
        <div><label>L2 - 驻转 砖 住 (')</label><input type="number" step="0.01" id="L2"></div>
        <div><label>P - 注住 砖 (拽")</label><input type="number" step="0.01" id="P_calc"></div>
        <div><label>L - 驻转   (')</label><input type="number" step="0.01" id="L_fill"></div>
    </div>

    <div class="section-title">砖 注住 专 (10.3.5 ')</div>
    <div class="field-group">
        <div><label>we - 抓 专 转 ('/"专)</label><input type="number" id="we_val"></div>
        <div><label>S - 砖  ("专)</label><input type="number" step="0.01" id="S_area"></div>
        <div><label>ws - 注住  (')</label><input type="number" id="ws_total"></div>
    </div>

    <div class="section-title">转爪转 拽</div>
    <table>
        <thead>
            <tr><th>住注祝</th><th>转专</th><th>转 I</th><th>砖专转 J</th><th>住拽</th></tr>
        </thead>
        <tbody>
            <tr><td>10.3.4 '</td><td>驻拽转 专转</td><td><input id="hor_a"></td><td><input id="res_a"></td><td><select id="stat_a"><option>转</option><option> 转</option></select></td></tr>
            <tr><td>10.3.4 '</td><td>驻拽转 专转</td><td><input id="hor_b"></td><td><input id="res_b"></td><td><select id="stat_b"><option>转</option><option> 转</option></select></td></tr>
            <tr><td>10.3.5 '</td><td> </td><td><input id="hor_c"></td><td><input id="res_c"></td><td><select id="stat_c"><option>转</option><option> 转</option></select></td></tr>
        </tbody>
    </table>

    <div class="section-title">住 转转</div>
    <div class="field-group">
        <div style="grid-column: span 2;"><label>住拽 住驻转</label><input type="text" id="conclusion" value="注拽 注 专砖转 转拽"></div>
        <div><label>砖 拽</label><input type="text" id="testerName"></div>
        <div><label>砖 砖专</label><input type="text" id="approverName"></div>
    </div>

    <button class="btn" onclick="generate()"> 驻拽 拽住  -  砖转</button>
</div>

<script>
    async function generate() {
        const data = {};
        document.querySelectorAll('input, select').forEach(el => data[el.id] = el.value);
        const res = await fetch('/generate-excel', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(data)
        });
        const blob = await res.blob();
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "Railing_Report_Complete.xlsx";
        a.click();
    }
</script>
</body>
</html>
