<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>מערכת בדיקת מעקה</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; display: flex; justify-content: center; padding: 20px; }
        .form-container { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 400px; }
        input, select { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        .download-link { display: block; text-align: center; margin-top: 20px; color: #28a745; text-decoration: none; font-weight: bold; }
    </style>
</head>
<body>

<div class="form-container">
    <h2>הזנת דו"ח בדיקה</h2>
    <input type="date" id="testDate" placeholder="תאריך בדיקה">
    <input type="text" id="siteName" placeholder="שם האתר">
    <input type="text" id="projectId" placeholder="קוד פרויקט">
    <input type="text" id="clientName" placeholder="שם המזמין">
    <input type="text" id="location" placeholder="מיקום (קומה/דירה)">
    <input type="text" id="itemDescription" placeholder="תיאור הפריט (מעקה אלומניום וכו')">
    <button onclick="saveData()">שמור באקסל</button>
    <a href="/download" class="download-link">⬇️ הורד את קובץ האקסל המלא</a>
    <p id="msg" style="text-align: center;"></p>
</div>

<script>
    async function saveData() {
        const data = {
            testDate: document.getElementById('testDate').value,
            siteName: document.getElementById('siteName').value,
            projectId: document.getElementById('projectId').value,
            clientName: document.getElementById('clientName').value,
            location: document.getElementById('location').value,
            itemDescription: document.getElementById('itemDescription').value
        };

        const response = await fetch('/add-row', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });

        const resJson = await response.json();
        document.getElementById('msg').innerText = resJson.message;
    }
</script>

</body>
</html>
